!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("microsoftTeams",[],t):"object"==typeof exports?exports.microsoftTeams=t():e.microsoftTeams=t()}("undefined"!=typeof self?self:this,(()=>(()=>{var e={933:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,i=s(e),a=i[0],l=i[1],u=new o(c(e,a,l)),d=0,f=l>0?a-4:a;for(n=0;n<f;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[d++]=t>>16&255,u[d++]=t>>8&255,u[d++]=255&t;2===l&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[d++]=255&t);1===l&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[d++]=t>>8&255,u[d++]=255&t);return u},t.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=16383,s=0,c=r-o;s<c;s+=a)i.push(u(e,s,s+a>c?c:s+a));1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return i.join("")};for(var n=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0;a<64;++a)n[a]=i[a],r[i.charCodeAt(a)]=a;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,n){return 3*(t+n)/4-n}function l(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function u(e,t,n){for(var r,o=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(l(r));return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},815:(e,t,n)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(o=r))})),t.splice(o,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(530)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},530:(e,t,n)=>{e.exports=function(e){function t(e){let n,o,i,a=null;function s(...e){if(!s.enabled)return;const r=s,o=Number(new Date),i=o-(n||o);r.diff=i,r.prev=n,r.curr=o,n=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=t.formatters[o];if("function"==typeof i){const t=e[a];n=i.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(821),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},821:e=>{var t=1e3,n=60*t,r=60*n,o=24*r,i=7*o;function a(e){if(!((e=String(e)).length>100)){var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(a){var s=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return s*i;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}function s(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=r?Math.round(e/r)+"h":i>=n?Math.round(e/n)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}function c(e){var i=Math.abs(e);return i>=o?l(e,i,o,"day"):i>=r?l(e,i,r,"hour"):i>=n?l(e,i,n,"minute"):i>=t?l(e,i,t,"second"):e+" ms"}function l(e,t,n,r){var o=t>=1.5*n;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return a(e);if("number"===n&&isFinite(e))return t.long?c(e):s(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"==typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"==typeof r.then)return r}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>r[e]));return a.default=()=>r,n.d(i,a),i}})(),(()=>{n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})();var r={};return(()=>{"use strict";n.r(r),n.d(r,{ActionObjectType:()=>Pe,AppId:()=>Ur,ChannelType:()=>cn,ChildAppWindow:()=>vg,DialogDimension:()=>sn,EduType:()=>xe,EmailAddress:()=>Wf,ErrorCode:()=>Re,FileOpenPreference:()=>Te,FrameContexts:()=>rn,HostClientType:()=>tn,HostName:()=>nn,LiveShareHost:()=>$v,NotificationTypes:()=>Tc,ParentAppWindow:()=>wg,SecondaryM365ContentIdName:()=>Oe,TaskModuleDimension:()=>sn,TeamType:()=>on,UUID:()=>Vn,UserSettingTypes:()=>Oc,UserTeamRole:()=>an,ViewerActionTypes:()=>Pc,app:()=>i,appEntity:()=>D,appInitialization:()=>be,appInstallDialog:()=>G,authentication:()=>q,barCode:()=>K,calendar:()=>ae,call:()=>ye,chat:()=>Q,clipboard:()=>Z,conversations:()=>S,copilot:()=>I,dialog:()=>f,enablePrintCapability:()=>rv,executeDeepLink:()=>Cv,externalAppAuthentication:()=>T,externalAppAuthenticationForCEA:()=>P,externalAppCardActions:()=>O,externalAppCardActionsForCEA:()=>R,externalAppCommands:()=>F,files:()=>k,geoLocation:()=>ee,getAdaptiveCardSchemaVersion:()=>mg,getContext:()=>iv,getMruTabInstances:()=>vv,getTabInstances:()=>hv,hostEntity:()=>z,initialize:()=>nv,initializeWithFrameContext:()=>bv,liveShare:()=>Ie,location:()=>ne,logs:()=>b,mail:()=>ce,marketplace:()=>Ue,media:()=>J,meeting:()=>oe,meetingRoom:()=>M,menus:()=>p,messageChannels:()=>N,monetization:()=>ie,navigateBack:()=>Tv,navigateCrossDomain:()=>Iv,navigateToTab:()=>Av,nestedAppAuth:()=>X,notifications:()=>x,openFilePreview:()=>Lc,otherAppStateChange:()=>L,pages:()=>y,people:()=>ue,print:()=>ov,profile:()=>de,registerAppButtonClickHandler:()=>cv,registerAppButtonHoverEnterHandler:()=>lv,registerAppButtonHoverLeaveHandler:()=>uv,registerBackButtonHandler:()=>dv,registerBeforeUnloadHandler:()=>pv,registerChangeSettingsHandler:()=>mv,registerCustomHandler:()=>Nc,registerFocusEnterHandler:()=>gv,registerFullScreenHandler:()=>sv,registerOnLoadHandler:()=>fv,registerOnThemeChangeHandler:()=>av,registerUserSettingsChangeHandler:()=>xc,remoteCamera:()=>U,returnFocus:()=>Ev,search:()=>fe,secondaryBrowser:()=>te,sendCustomEvent:()=>Mc,sendCustomMessage:()=>kc,setFrameContext:()=>yv,settings:()=>Ee,shareDeepLink:()=>wv,sharing:()=>ge,stageView:()=>he,store:()=>$,tasks:()=>Ae,teams:()=>_,teamsCore:()=>le,thirdPartyCloudStorage:()=>Se,uploadCustomApp:()=>Fc,version:()=>fr,videoEffects:()=>B,videoEffectsEx:()=>W,visualMedia:()=>we,webStorage:()=>Ce});var e={};n.r(e),n.d(e,{_clearTelemetryPort:()=>zr,getTelemetryPort:()=>Wr,isSupported:()=>jr});var t={};n.r(t),n.d(t,{_clearDataLayerPort:()=>Zr,getDataLayerPort:()=>Kr,isSupported:()=>Qr});var o={};n.r(o),n.d(o,{registerBeforeSuspendOrTerminateHandler:()=>Xr,registerOnResumeHandler:()=>Yr});var i={};n.r(i),n.d(i,{ExpectedFailureReason:()=>oo,FailedReason:()=>ro,Messages:()=>no,_initialize:()=>co,_uninitialize:()=>lo,getContext:()=>uo,getFrameContext:()=>ao,initialize:()=>so,isInitialized:()=>io,lifecycle:()=>o,notifyAppLoaded:()=>fo,notifyExpectedFailure:()=>mo,notifyFailure:()=>go,notifySuccess:()=>po,openLink:()=>wo,registerHostToAppPerformanceMetricsHandler:()=>vo,registerOnThemeChangeHandler:()=>ho});var a={};n.r(a),n.d(a,{isSupported:()=>bo,resize:()=>yo});var s={};n.r(s),n.d(s,{isSupported:()=>Eo,open:()=>So});var c={};n.r(c),n.d(c,{isSupported:()=>Po,registerOnMessageFromParent:()=>To,sendMessageToDialog:()=>Io,sendMessageToParentFromDialog:()=>Ao});var l={};n.r(l),n.d(l,{bot:()=>s,getDialogInfoFromBotUrlDialogInfo:()=>Mo,getDialogInfoFromUrlDialogInfo:()=>ko,isSupported:()=>Fo,open:()=>Oo,parentCommunication:()=>c,submit:()=>Ro});var u={};n.r(u),n.d(u,{isSupported:()=>jo,open:()=>Wo});var d={};n.r(d),n.d(d,{bot:()=>u,isSupported:()=>$o,open:()=>zo});var f={};n.r(f),n.d(f,{adaptiveCard:()=>d,initialize:()=>qo,isSupported:()=>Go,update:()=>a,url:()=>l});var p={};n.r(p),n.d(p,{DisplayMode:()=>Ko,MenuItem:()=>Zo,MenuListType:()=>Qo,initialize:()=>ri,isSupported:()=>ui,setNavBarMenu:()=>ai,setUpViews:()=>oi,showActionMenu:()=>ci});var g={};n.r(g),n.d(g,{initialize:()=>di,isSupported:()=>Ei,registerChangeConfigHandler:()=>Ci,registerOnRemoveHandler:()=>hi,registerOnRemoveHandlerHelper:()=>vi,registerOnSaveHandler:()=>gi,registerOnSaveHandlerHelper:()=>mi,setConfig:()=>pi,setValidityState:()=>fi});var m={};n.r(m),n.d(m,{isSupported:()=>Xi,onClick:()=>Ki,onHoverEnter:()=>Qi,onHoverLeave:()=>Zi});var h={};n.r(h),n.d(h,{_initialize:()=>Yi,isSupported:()=>ra,navigateBack:()=>ea,registerBackButtonHandler:()=>ta,registerBackButtonHandlerHelper:()=>na});var v={};n.r(v),n.d(v,{isSupported:()=>aa,navigateTo:()=>oa,navigateToDefaultPage:()=>ia});var w={};n.r(w),n.d(w,{enterFullscreen:()=>sa,exitFullscreen:()=>ca,isSupported:()=>la});var C={};n.r(C),n.d(C,{getMruTabInstances:()=>fa,getTabInstances:()=>da,isSupported:()=>pa,navigateToTab:()=>ua});var y={};n.r(y),n.d(y,{EnterFocusType:()=>ga,ReturnFocusType:()=>ma,appButton:()=>m,backStack:()=>h,config:()=>g,currentApp:()=>v,fullTrust:()=>w,getConfig:()=>ya,initializeWithFrameContext:()=>Ca,isSupported:()=>Ia,navigateCrossDomain:()=>ba,navigateToApp:()=>Sa,registerFocusEnterHandler:()=>va,registerFullScreenHandler:()=>Aa,returnFocus:()=>ha,setCurrentFrame:()=>wa,shareDeepLink:()=>Ea,tabs:()=>C});var b={};n.r(b),n.d(b,{isSupported:()=>Ic,registerGetLogHandler:()=>Ac});var S={};n.r(S),n.d(S,{closeConversation:()=>Hc,getChatMembers:()=>Vc,isSupported:()=>_c,openConversation:()=>Dc});var E={};n.r(E),n.d(E,{isSupported:()=>zc,sendCustomTelemetryData:()=>$c});var A={};n.r(A),n.d(A,{getEligibilityInfo:()=>Qc,isSupported:()=>Kc});var I={};n.r(I),n.d(I,{customTelemetry:()=>E,eligibility:()=>A});var T={};n.r(T),n.d(T,{ActionExecuteInvokeRequestType:()=>tl,ActionExecuteResponseHandler:()=>il,InvokeErrorCode:()=>ol,InvokeResponseType:()=>rl,OriginalRequestType:()=>nl,SerializableActionExecuteInvokeRequest:()=>Yc,authenticateAndResendRequest:()=>ul,authenticateWithOauth2:()=>pl,authenticateWithPowerPlatformConnectorPlugins:()=>gl,authenticateWithSSO:()=>dl,authenticateWithSSOAndResendRequest:()=>fl,isActionExecuteResponse:()=>el,isInvokeError:()=>al,isSupported:()=>ml,validateActionExecuteInvokeRequest:()=>cl});var P={};n.r(P),n.d(P,{authenticateAndResendRequest:()=>yl,authenticateWithOauth:()=>Cl,authenticateWithSSO:()=>wl,authenticateWithSSOAndResendRequest:()=>bl,isSupported:()=>Sl,validateInput:()=>El});var O={};n.r(O),n.d(O,{ActionOpenUrlErrorCode:()=>Tl,ActionOpenUrlType:()=>Il,isSupported:()=>Rl,processActionOpenUrl:()=>Ol,processActionSubmit:()=>Pl});var R={};n.r(R),n.d(R,{isSupported:()=>xl,processActionOpenUrl:()=>Ml,processActionSubmit:()=>Nl});var F={};n.r(F),n.d(F,{isSupported:()=>Hl,processActionCommand:()=>Dl});var k={};n.r(k),n.d(k,{CloudStorageProvider:()=>_l,CloudStorageProviderFileAction:()=>$l,CloudStorageProviderType:()=>Bl,DocumentLibraryAccessType:()=>jl,FileDownloadStatus:()=>zl,SpecialDocumentLibraryType:()=>Wl,addCloudStorageFolder:()=>Gl,addCloudStorageProvider:()=>tu,addCloudStorageProviderFile:()=>ru,copyMoveFiles:()=>Xl,deleteCloudStorageFolder:()=>Jl,deleteCloudStorageProviderFile:()=>iu,downloadCloudStorageProviderFile:()=>au,getCloudStorageFolderContents:()=>Kl,getCloudStorageFolders:()=>ql,getExternalProviders:()=>Zl,getFileDownloads:()=>Yl,openCloudStorageFile:()=>Ql,openDownloadFolder:()=>eu,registerCloudStorageProviderContentChangeHandler:()=>lu,registerCloudStorageProviderListChangeHandler:()=>cu,removeCloudStorageProvider:()=>nu,renameCloudStorageProviderFile:()=>ou,uploadCloudStorageProviderFile:()=>su});var M={};n.r(M),n.d(M,{getPairedMeetingRoomInfo:()=>fu,isSupported:()=>hu,registerMeetingRoomCapabilitiesUpdateHandler:()=>gu,registerMeetingRoomStatesUpdateHandler:()=>mu,sendCommandToPairedMeetingRoom:()=>pu});var N={};n.r(N),n.d(N,{dataLayer:()=>t,isSupported:()=>vu,telemetry:()=>e});var x={};n.r(x),n.d(x,{isSupported:()=>yu,showNotification:()=>Cu});var L={};n.r(L),n.d(L,{isSupported:()=>Iu,notifyInstallCompleted:()=>Au,registerAppInstallationHandler:()=>Su,unregisterAppInstallationHandler:()=>Eu});var U={};n.r(U),n.d(U,{ControlCommand:()=>Pu,ErrorReason:()=>Ou,SessionTerminatedReason:()=>Ru,getCapableParticipants:()=>Fu,isSupported:()=>Hu,registerOnCapableParticipantsChangeHandler:()=>xu,registerOnDeviceStateChangeHandler:()=>Uu,registerOnErrorHandler:()=>Lu,registerOnSessionStatusChangeHandler:()=>Du,requestControl:()=>ku,sendControlCommand:()=>Mu,terminateSession:()=>Nu});var D={};n.r(D),n.d(D,{isSupported:()=>Bu,selectAppEntity:()=>_u});var H={};n.r(H),n.d(H,{getUserJoinedTeams:()=>ju,isSupported:()=>zu});var V={};n.r(V),n.d(V,{getConfigSetting:()=>qu,isSupported:()=>Gu,joinedTeams:()=>H});var _={};n.r(_),n.d(_,{ChannelType:()=>Ku,fullTrust:()=>V,getTeamChannels:()=>Qu,isSupported:()=>Xu,refreshSiteUrl:()=>Zu});var B={};n.r(B),n.d(B,{EffectChangeType:()=>cd,EffectFailureReason:()=>ld,VideoFrameFormat:()=>sd,isSupported:()=>md,notifySelectedVideoEffectChanged:()=>dd,registerForVideoEffect:()=>fd,registerForVideoFrame:()=>ud});var W={};n.r(W),n.d(W,{ErrorLevel:()=>Vd,frameProcessingTimeoutInMs:()=>Dd,isSupported:()=>Gd,notifyFatalError:()=>Qd,notifySelectedVideoEffectChanged:()=>zd,registerForVideoEffect:()=>$d,registerForVideoFrame:()=>_d,updatePersonalizedEffects:()=>qd});var j={};n.r(j),n.d(j,{addAndConfigure:()=>of,getAll:()=>af,isSupported:()=>uf,reconfigure:()=>sf,remove:()=>lf,rename:()=>cf});var z={};n.r(z),n.d(z,{AppTypes:()=>pf,isSupported:()=>gf,tab:()=>j});var $={};n.r($),n.d($,{isSupported:()=>Af,openAppDetail:()=>bf,openFullStore:()=>yf,openInContextStore:()=>Sf,openSpecificStore:()=>Ef});var q={};n.r(q),n.d(q,{DataResidency:()=>_f,authenticate:()=>Mf,getAuthToken:()=>xf,getUser:()=>Uf,notifyFailure:()=>Vf,notifySuccess:()=>Hf,registerAuthenticationHandlers:()=>kf});var G={};n.r(G),n.d(G,{isSupported:()=>lp,openAppInstallDialog:()=>cp});var J={};n.r(J),n.d(J,{CameraStartMode:()=>gp,File:()=>Cp,FileFormat:()=>fp,ImageOutputFormats:()=>wp,ImageUriType:()=>vp,Media:()=>Ap,MediaControllerEvent:()=>pp,MediaType:()=>hp,Source:()=>mp,VideoController:()=>Tp,captureImage:()=>yp,hasPermission:()=>bp,requestPermission:()=>Sp,scanBarCode:()=>Rp,selectMedia:()=>Pp,viewImages:()=>Op});var K={};n.r(K),n.d(K,{hasPermission:()=>zp,isSupported:()=>qp,requestPermission:()=>$p,scanBarCode:()=>jp});var Q={};n.r(Q),n.d(Q,{isSupported:()=>Zp,openChat:()=>Jp,openGroupChat:()=>Qp});var Z={};n.r(Z),n.d(Z,{isSupported:()=>ng,read:()=>tg,write:()=>eg});var X={};n.r(X),n.d(X,{isNAAChannelRecommended:()=>rg});var Y={};n.r(Y),n.d(Y,{chooseLocation:()=>sg,isSupported:()=>lg,showLocation:()=>cg});var ee={};n.r(ee),n.d(ee,{getCurrentLocation:()=>dg,hasPermission:()=>fg,isSupported:()=>gg,map:()=>Y,requestPermission:()=>pg});var te={};n.r(te),n.d(te,{isSupported:()=>bg,open:()=>yg});var ne={};n.r(ne),n.d(ne,{getLocation:()=>Eg,isSupported:()=>Ig,showLocation:()=>Ag});var re={};n.r(re),n.d(re,{setOptions:()=>Pg});var oe={};n.r(oe),n.d(oe,{CallType:()=>Ng,EventActionSource:()=>Lg,MeetingReactionType:()=>kg,MeetingType:()=>Mg,SharingProtocol:()=>xg,appShareButton:()=>re,getAppContentStageSharingCapabilities:()=>qg,getAppContentStageSharingState:()=>Jg,getAuthenticationTokenForAnonymousUser:()=>_g,getIncomingClientAudioState:()=>Ug,getLiveStreamState:()=>Bg,getMeetingDetails:()=>Hg,getMeetingDetailsVerbose:()=>Vg,joinMeeting:()=>Xg,registerLiveStreamChangedHandler:()=>zg,registerMeetingReactionReceivedHandler:()=>Zg,registerRaiseHandStateChangedHandler:()=>Qg,registerSpeakingStateChangeHandler:()=>Kg,requestAppAudioHandling:()=>Yg,requestStartLiveStreaming:()=>Wg,requestStopLiveStreaming:()=>jg,shareAppContentToStage:()=>$g,stopSharingAppContentToStage:()=>Gg,toggleIncomingClientAudio:()=>Dg,updateMicState:()=>nm});var ie={};n.r(ie),n.d(ie,{isSupported:()=>sm,openPurchaseExperience:()=>am});var ae={};n.r(ae),n.d(ae,{composeMeeting:()=>um,isSupported:()=>dm,openCalendarItem:()=>lm});var se={};n.r(se),n.d(se,{composeMailWithHandoff:()=>mm,isSupported:()=>hm});var ce={};n.r(ce),n.d(ce,{ComposeMailType:()=>Sm,composeMail:()=>ym,handoff:()=>se,isSupported:()=>bm,openMailItem:()=>Cm});var le={};n.r(le),n.d(le,{enablePrintCapability:()=>Am,isSupported:()=>Fm,print:()=>Im,registerBeforeUnloadHandler:()=>Om,registerBeforeUnloadHandlerHelper:()=>Rm,registerOnLoadHandler:()=>Tm,registerOnLoadHandlerHelper:()=>Pm});var ue={};n.r(ue),n.d(ue,{isSupported:()=>Lm,selectPeople:()=>Nm});var de={};n.r(de),n.d(de,{isSupported:()=>_m,showProfile:()=>Vm});var fe={};n.r(fe),n.d(fe,{closeSearch:()=>Jm,isSupported:()=>Gm,registerHandlers:()=>$m,unregisterHandlers:()=>qm});var pe={};n.r(pe),n.d(pe,{getContent:()=>Zm,isSupported:()=>Xm});var ge={};n.r(ge),n.d(ge,{SharingAPIMessages:()=>th,history:()=>pe,isSupported:()=>sh,shareWebContent:()=>nh});var me={};n.r(me),n.d(me,{close:()=>lh,isSupported:()=>uh});var he={};n.r(he),n.d(he,{StageViewOpenMode:()=>fh,isSupported:()=>gh,open:()=>ph,self:()=>me});var ve={};n.r(ve),n.d(ve,{captureImages:()=>wh,isSupported:()=>yh,retrieveImages:()=>Ch});var we={};n.r(we),n.d(we,{CameraRestriction:()=>Ih,Source:()=>Th,hasPermission:()=>Ph,image:()=>ve,requestPermission:()=>Oh});var Ce={};n.r(Ce),n.d(Ce,{isSupported:()=>Lh,isWebStorageClearedOnUserLogOut:()=>Nh});var ye={};n.r(ye),n.d(ye,{CallModalities:()=>Dh,isSupported:()=>Vh,startCall:()=>Hh});var be={};n.r(be),n.d(be,{ExpectedFailureReason:()=>oo,FailedReason:()=>ro,Messages:()=>no,notifyAppLoaded:()=>Bh,notifyExpectedFailure:()=>zh,notifyFailure:()=>jh,notifySuccess:()=>Wh});var Se={};n.r(Se),n.d(Se,{getDragAndDropFiles:()=>Xh,isSupported:()=>ev});var Ee={};n.r(Ee),n.d(Ee,{getSettings:()=>Rv,registerOnRemoveHandler:()=>Mv,registerOnSaveHandler:()=>kv,setSettings:()=>Fv,setValidityState:()=>Ov});var Ae={};n.r(Ae),n.d(Ae,{getDefaultSizeIfNotProvided:()=>_v,startTask:()=>Lv,submitTask:()=>Dv,updateTask:()=>Uv});var Ie={};n.r(Ie),n.d(Ie,{ContainerState:()=>jv,LiveShareHost:()=>$v,UserMeetingRole:()=>Wv,isSupported:()=>zv});var Te,Pe,Oe,Re,Fe,ke,Me,Ne,xe,Le,Ue={};function De(e){return void 0!==(null==e?void 0:e.errorCode)}n.r(Ue),n.d(Ue,{CartStatus:()=>sw,Intent:()=>aw,addOrUpdateCartItems:()=>lw,cartVersion:()=>iw,getCart:()=>cw,isSupported:()=>fw,removeCartItems:()=>uw,updateCartStatus:()=>dw}),function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(Te||(Te={})),function(e){e.M365Content="m365content"}(Pe||(Pe={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(Oe||(Oe={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(Re||(Re={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(Fe||(Fe={})),function(e){e.BCAIS="bcais",e.BCWAF="bcwaf",e.BCWBF="bcwbf"}(ke||(ke={})),function(e){e.Faculty="faculty",e.Student="student",e.Other="other"}(Me||(Me={})),function(e){e.Adult="adult",e.MinorNoParentalConsentRequired="minorNoParentalConsentRequired",e.MinorWithoutParentalConsent="minorWithoutParentalConsent",e.MinorWithParentalConsent="minorWithParentalConsent",e.NonAdult="nonAdult"}(Ne||(Ne={})),function(e){e.HigherEducation="higherEducation",e.K12="k12",e.Other="other"}(xe||(xe={})),function(e){e.TextPlain="text/plain",e.TextHtml="text/html",e.ImagePNG="image/png",e.ImageJPEG="image/jpeg"}(Le||(Le={}));const He=JSON.parse('{"validOrigins":["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","outlook.live.com","outlook-sdf.live.com","teams.live.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","devspaces.skype.com","*.www.office.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.microsoft365.com","www.microsoft365.com","bing.com","edgeservices.bing.com","work.bing.com","www.bing.com","www.staging-bing-int.com","*.cloud.microsoft","*.m365.cloud.microsoft","chatuxmanager.svc.cloud.microsoft","copilot.microsoft.com","windows.msn.com","fa000000125.resources.office.net","fa000000129.resources.office.net","fa000000124.resources.office.net","fa000000128.resources.office.net","fa000000136.resources.office.net"]}');const Ve="2.0.1",_e="2.0.2",Be="2.0.3",We="2.0.4",je="2.0.1",ze="1.9.0",$e="2.0.0",qe="1.7.0",Ge="1.8.0",Je="1.9.0",Ke=n.t(He,2).validOrigins,Qe=1500,Ze=new URL("https://res.cdn.office.net/teams-js/validDomains/json/validDomains.json"),Xe=/^https:\/\//,Ye="https",et="teams.microsoft.com",tt="The library has not yet been initialized",nt="The runtime has not yet been initialized",rt="The runtime version is not supported",ot="The call was not properly started";class it{}it.initializeCalled=!1,it.initializeCompleted=!1,it.additionalValidOrigins=[],it.initializePromise=void 0,it.isFramelessWindow=!1,it.frameContext=void 0,it.hostClientType=void 0,it.printCapabilityEnabled=!1;var at=n(815),st=n(933);const ct=ut,lt=2147483647;function ut(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return ft(e)}return dt(e,t,n)}function dt(e,t,n){if("string"==typeof e)return ht(e,t);if(ArrayBuffer.isView(e))return Et(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(wt(e,ArrayBuffer)||e&&wt(e.buffer,ArrayBuffer))return At(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(wt(e,SharedArrayBuffer)||e&&wt(e.buffer,SharedArrayBuffer)))return At(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return ut.from(r,t,n);const o=$t(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return ut.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function ft(e){return pt(e),gt(e<0?0:0|mt(e))}function pt(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function gt(e){if(e>lt)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,ut.prototype),t}function mt(e){if(e>=lt)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+lt.toString(16)+" bytes");return 0|e}function ht(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!ut.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|vt(e,t);let r=gt(n);const o=r.write(e,t);return o!==n&&(r=r.slice(0,o)),r}function vt(e,t){if(ut.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||wt(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Ct(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return yt(e).length;default:if(o)return r?-1:Ct(e).length;t=(""+t).toLowerCase(),o=!0}}function wt(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Ct(e,t){let n;t=t||1/0;const r=e.length;let o=null;const i=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!o){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function yt(e){return st.toByteArray(St(e))}ut.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),ut.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required"),ut.from=function(e,t,n){return dt(e,t,n)},Object.setPrototypeOf(ut.prototype,Uint8Array.prototype),Object.setPrototypeOf(ut,Uint8Array),ut.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ut.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==ut.prototype};const bt=/[^+/0-9A-Za-z-_]/g;function St(e){if((e=(e=e.split("=")[0]).trim().replace(bt,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function Et(e){if(wt(e,Uint8Array)){const t=new Uint8Array(e);return At(t.buffer,t.byteOffset,t.byteLength)}return It(e)}function At(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,ut.prototype),r}function It(e){const t=e.length<0?0:0|mt(e.length),n=gt(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function Tt(e,t,n){n=Math.min(e.length,n);const r=[];let o=t;for(;o<n;){const t=e[o];let i=null,a=t>239?4:t>223?3:t>191?2:1;if(o+a<=n){let n,r,s,c;switch(a){case 1:t<128&&(i=t);break;case 2:n=e[o+1],128==(192&n)&&(c=(31&t)<<6|63&n,c>127&&(i=c));break;case 3:n=e[o+1],r=e[o+2],128==(192&n)&&128==(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=e[o+1],r=e[o+2],s=e[o+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=a}return Rt(r)}function Pt(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Ft(this,t,n);case"utf8":case"utf-8":return Tt(this,t,n);case"ascii":return kt(this,t,n);case"latin1":case"binary":return Mt(this,t,n);case"base64":return Nt(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xt(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}ut.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?Tt(this,0,e):Pt.apply(this,arguments)};const Ot=4096;function Rt(e){const t=e.length;if(t<=Ot)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=Ot));return n}function Ft(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=t;r<n;++r)o+=zt[e[r]];return o}function kt(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(127&e[o]);return r}function Mt(e,t,n){let r="";n=Math.min(e.length,n);for(let o=t;o<n;++o)r+=String.fromCharCode(e[o]);return r}function Nt(e,t,n){return 0===t&&n===e.length?st.fromByteArray(e):st.fromByteArray(e.slice(t,n))}function xt(e,t,n){const r=e.slice(t,n);let o="";for(let e=0;e<r.length-1;e+=2)o+=String.fromCharCode(r[e]+256*r[e+1]);return o}function Lt(e,t,n,r){n=Number(n)||0;const o=e.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=t.length;let a;for(r>i/2&&(r=i/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(jt(r))return a;e[n+a]=r}return a}function Ut(e,t,n,r){return Wt(Ct(t,e.length-n),e,n,r)}function Dt(e,t,n,r){return Wt(_t(t),e,n,r)}function Ht(e,t,n,r){return Wt(yt(t),e,n,r)}function Vt(e,t,n,r){return Wt(Bt(t,e.length-n),e,n,r)}function _t(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}function Bt(e,t){let n,r,o;const i=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,o=n%256,i.push(o),i.push(r);return i}function Wt(e,t,n,r){let o;for(o=0;o<r&&!(o+n>=t.length||o>=e.length);++o)t[o+n]=e[o];return o}function jt(e){return e!=e}ut.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-t;if((void 0===n||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return Lt(this,e,t,n);case"utf8":case"utf-8":return Ut(this,e,t,n);case"ascii":case"latin1":case"binary":return Dt(this,e,t,n);case"base64":return Ht(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vt(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}};const zt=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)t[r+o]=e[n]+e[o]}return t}();function $t(e){if(ut.isBuffer(e)){const t=0|mt(e.length),n=gt(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||jt(e.length)?gt(0):It(e):"Buffer"===e.type&&Array.isArray(e.data)?It(e.data):void 0}const qt={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let Gt;const Jt=new Uint8Array(16);function Kt(){if(!Gt&&(Gt="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Gt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Gt(Jt)}const Qt=[];for(let e=0;e<256;++e)Qt.push((e+256).toString(16).slice(1));function Zt(e,t=0){return Qt[e[t+0]]+Qt[e[t+1]]+Qt[e[t+2]]+Qt[e[t+3]]+"-"+Qt[e[t+4]]+Qt[e[t+5]]+"-"+Qt[e[t+6]]+Qt[e[t+7]]+"-"+Qt[e[t+8]]+Qt[e[t+9]]+"-"+Qt[e[t+10]]+Qt[e[t+11]]+Qt[e[t+12]]+Qt[e[t+13]]+Qt[e[t+14]]+Qt[e[t+15]]}const Xt=function(e,t,n){if(qt.randomUUID&&!t&&!e)return qt.randomUUID();const r=(e=e||{}).random||(e.rng||Kt)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return Zt(r)},Yt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const en=function(e){return"string"==typeof e&&Yt.test(e)};var tn,nn,rn,on,an,sn,cn;!function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.macos="macos",e.visionOS="visionOS",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(tn||(tn={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.places="Places",e.teams="Teams",e.teamsModern="TeamsModern"}(nn||(nn={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(rn||(rn={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(on||(on={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(an||(an={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(sn||(sn={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(cn||(cn={}));const ln={errorCode:Re.NOT_SUPPORTED_ON_PLATFORM},un={majorVersion:1,minorVersion:5},dn={adaptiveCardSchemaVersion:{majorVersion:1,minorVersion:5}},fn=new Error("Invalid input count: Must supply a valid image count (limit of 10)."),pn=new Error("Invalid response: Received more images than the specified max limit in the response.");function gn(e){return(t,n)=>{if(!t)throw new Error(e||n)}}function mn(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;const n=e.split("."),r=t.split(".");function o(e){return/^\d+$/.test(e)}if(!n.every(o)||!r.every(o))return NaN;for(;n.length<r.length;)n.push("0");for(;r.length<n.length;)r.push("0");for(let e=0;e<n.length;++e)if(Number(n[e])!=Number(r[e]))return Number(n[e])>Number(r[e])?1:-1;return 0}function hn(){return Xt()}function vn(e){return Object.keys(e).forEach((t=>{null!==e[t]&&void 0!==e[t]&&"object"==typeof e[t]&&vn(e[t])})),Object.freeze(e)}function wn(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(void 0,e)})).catch((e=>{t&&t(e)})),r}function Cn(e,t,...n){const r=e(...n);return r.then((()=>{t&&t(null)})).catch((e=>{t&&t(e)})),r}function yn(e,t,...n){const r=e(...n);return r.then((e=>{t&&t(null,e)})).catch((e=>{t&&t(e,null)})),r}function bn(e,t,n){return new Promise(((r,o)=>{const i=setTimeout(o,t,n);e().then((e=>{clearTimeout(i),r(e)})).catch((e=>{clearTimeout(i),o(e)}))}))}function Sn(e){const t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId.toString())+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl.toString()),(e.chatId||e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({chatId:e.chatId,channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}function En(e){return!(mn(`${e.majorVersion}.${e.minorVersion}`,`${un.majorVersion}.${un.minorVersion}`)>=0)}function An(e){return"https:"===e.protocol}function In(e,t){return new Promise(((n,r)=>{if(e||r("MimeType cannot be null or empty."),t||r("Base64 string cannot be null or empty."),e.startsWith("image/")){const r=atob(t),o=new Uint8Array(r.length);for(let e=0;e<r.length;e++)o[e]=r.charCodeAt(e);n(new Blob([o],{type:e}))}const o=ct.from(t,"base64").toString();n(new Blob([o],{type:e}))}))}function Tn(e){return new Promise(((t,n)=>{0===e.size&&n(new Error("Blob cannot be empty."));const r=new FileReader;r.onloadend=()=>{r.result?t(r.result.toString().split(",")[1]):n(new Error("Failed to read the blob"))},r.onerror=()=>{n(r.error)},r.readAsDataURL(e)}))}function Pn(){if(On())throw new Error("window object undefined at SSR check");return window}function On(){return"undefined"==typeof window}function Rn(e,t){if(Mn(e)||!Nn(e)||!xn(e))throw t||new Error("id is not valid.")}function Fn(e,t){const n=e.toString().toLocaleLowerCase();if(Mn(n))throw t||new Error("Invalid Url");if(n.length>2048)throw t||new Error("Url exceeds the maximum size of 2048 characters");if(!An(e))throw t||new Error("Url should be a valid https url")}function kn(e){const t=document.createElement("a");return t.href=e,new URL(t.href)}function Mn(e){return new RegExp(`${/<script[^>]*>|&lt;script[^&]*&gt;|%3Cscript[^%]*%3E/gi.source}|${/<\/script[^>]*>|&lt;\/script[^&]*&gt;|%3C\/script[^%]*%3E/gi.source}`,"gi").test(e)}function Nn(e){return e.length<256&&e.length>4}function xn(e){for(let t=0;t<e.length;t++){const n=e.charCodeAt(t);if(n<32||n>126)return!1}return!0}function Ln(e){if(!e)throw new Error("id must not be empty");if(!1===en(e))throw new Error("id must be a valid UUID")}const Un=!!performance&&"now"in performance;function Dn(){return Un?performance.now()+performance.timeOrigin:void 0}function Hn(e,t=0){if(t>1e3)return!1;if(void 0===e||"boolean"==typeof e||"number"==typeof e||"bigint"==typeof e||"string"==typeof e||null===e)return!0;if(Array.isArray(e))return e.every((e=>Hn(e,t+1)));return!("object"!=typeof e||"[object Object]"!==Object.prototype.toString.call(e)||Object.getPrototypeOf(e)!==Object.prototype&&null!==Object.getPrototypeOf(e))&&Object.keys(e).every((n=>Hn(e[n],t+1)))}class Vn{constructor(e=hn()){this.uuid=e,Ln(e)}toString(){return this.uuid}}const _n=new Vn,Bn=at.debug.formatArgs;at.debug.formatArgs=function(e){e[0]=`(${(new Date).toISOString()}): ${e[0]} [${_n.toString()}]`,Bn.call(this,e)};const Wn=(0,at.debug)("teamsJs");function jn(e){return Wn.extend(e)}function zn(e,t){return`${e}_${t}`}function $n(e){return/^v\d+_[\w.]+$/.test(e)}var qn=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const Gn=jn("runtime"),Jn=4;function Kn(e){return e.apiVersion===Jn}const Qn={apiVersion:-1,supports:{}};function Zn(e){if(Kn(e))return!0;throw-1===e.apiVersion?new Error(nt):new Error(rt)}let Xn=Qn;const Yn={apiVersion:4,isNAAChannelRecommended:!1,hostVersionsInfo:dn,isLegacyTeams:!0,supports:{appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{card:{bot:{}},url:{bot:{},parentCommunication:{}},update:{}},interactive:{},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{config:{},backStack:{},fullTrust:{}},remoteCamera:{},teams:{fullTrust:{}},teamsCore:{},video:{sharedFrame:{}}}},er=[tn.desktop,tn.web,tn.rigel,tn.surfaceHub,tn.teamsRoomsWindows,tn.teamsRoomsAndroid,tn.teamsPhones,tn.teamsDisplays],tr=[tn.android,tn.ios,tn.ipados,tn.visionOS],nr=[...er,...tr];function rr(e){let t=e;if(t.apiVersion<Jn&&or.forEach((e=>{t.apiVersion===e.versionToUpgradeFrom&&(t=e.upgradeToNextVersion(t))})),Kn(t))return t;throw new Error("Received a runtime that could not be upgraded to the latest version")}const or=[{versionToUpgradeFrom:1,upgradeToNextVersion:e=>{var t;return{apiVersion:2,hostVersionsInfo:void 0,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:void 0,url:e.supports.dialog,update:null===(t=e.supports.dialog)||void 0===t?void 0:t.update}:void 0})}}},{versionToUpgradeFrom:2,upgradeToNextVersion:e=>{const t=e.supports,{appNotification:n}=t,r=qn(t,["appNotification"]);return Object.assign(Object.assign({},e),{apiVersion:3,supports:r})}},{versionToUpgradeFrom:3,upgradeToNextVersion:e=>{var t,n,r,o,i;return{apiVersion:4,hostVersionsInfo:e.hostVersionsInfo,isNAAChannelRecommended:e.isNAAChannelRecommended,isLegacyTeams:e.isLegacyTeams,supports:Object.assign(Object.assign({},e.supports),{dialog:e.supports.dialog?{card:null===(t=e.supports.dialog)||void 0===t?void 0:t.card,url:{bot:null===(r=null===(n=e.supports.dialog)||void 0===n?void 0:n.url)||void 0===r?void 0:r.bot,parentCommunication:(null===(o=e.supports.dialog)||void 0===o?void 0:o.url)?{}:void 0},update:null===(i=e.supports.dialog)||void 0===i?void 0:i.update}:void 0})}}}],ir={"1.0.0":[{capability:{pages:{appButton:{},tabs:{}},stageView:{}},hostClientTypes:er}],"1.9.0":[{capability:{location:{}},hostClientTypes:nr}],"2.0.0":[{capability:{people:{}},hostClientTypes:nr},{capability:{sharing:{}},hostClientTypes:[tn.desktop,tn.web]}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[tn.android,tn.desktop,tn.ios,tn.teamsRoomsAndroid,tn.teamsPhones,tn.teamsDisplays,tn.web]},{capability:{webStorage:{}},hostClientTypes:[tn.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[tn.android,tn.ios]}],"2.0.8":[{capability:{sharing:{}},hostClientTypes:[tn.android,tn.ios]}],"2.1.1":[{capability:{nestedAppAuth:{}},hostClientTypes:[tn.android,tn.ios,tn.ipados,tn.visionOS]}]},ar=Gn.extend("generateBackCompatRuntimeConfig");function sr(e,t){const n=Object.assign({},e);for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&("object"!=typeof t[r]||Array.isArray(t[r])?r in e||(n[r]=t[r]):n[r]=sr(e[r]||{},t[r]));return n}function cr(e,t,n){ar("generating back compat runtime config for %s",e);let r=Object.assign({},t.supports);ar("Supported capabilities in config before updating based on highestSupportedVersion: %o",r),Object.keys(n).forEach((t=>{mn(e,t)>=0&&n[t].forEach((e=>{void 0!==it.hostClientType&&e.hostClientTypes.includes(it.hostClientType)&&(r=sr(r,e.capability))}))}));const o={apiVersion:Jn,hostVersionsInfo:dn,isLegacyTeams:!0,supports:r};return ar("Runtime config after updating based on highestSupportedVersion: %o",o),o}const lr=Gn.extend("applyRuntimeConfig");function ur(e){"string"==typeof e.apiVersion&&(lr("Trying to apply runtime with string apiVersion, processing as v1: %o",e),e=Object.assign(Object.assign({},e),{apiVersion:1})),lr("Fast-forwarding runtime %o",e);const t=rr(e);lr("Applying runtime %o",t),Xn=vn(t)}function dr(e){return null!=e&&void 0!==e.serialize&&"function"==typeof e.serialize}const fr="2.35.0";var pr=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const gr=e=>{const{uuid:t}=e,n=pr(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})},mr=e=>{const{uuidAsString:t}=e,n=pr(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new Vn(t):void 0})},hr=e=>{const{uuidAsString:t}=e,n=pr(e,["uuidAsString"]);return Object.assign(Object.assign({},n),{uuid:t?new Vn(t):void 0})},vr=e=>{const{uuid:t}=e,n=pr(e,["uuid"]),r=null==t?void 0:t.toString();return Object.assign(Object.assign({},n),{uuidAsString:r})};function wr(e){return void 0!==e.uuidAsString?`${e.uuidAsString} (legacy id: ${e.id})`:void 0!==e.uuid?`${e.uuid.toString()} (legacy id: ${e.id})`:`legacy id: ${e.id} (no uuid)`}const Cr=jn("flushMessageQueue");function yr(e,t,n,r){if(e&&t&&0!==n.length)for(;n.length>0;){const o=n.shift();if(o){const n=gr(o);Cr("Flushing message %s from %s message queue via postMessage.",wr(n),r),e.postMessage(n,t)}}}const br=jn("internal"),Sr=br.extend("ensureInitializeCalled"),Er=br.extend("ensureInitialized");function Ar(){if(!it.initializeCalled)throw Sr(tt),new Error(tt)}function Ir(e,...t){if(!it.initializeCompleted)throw Er("%s. initializeCalled: %s",tt,it.initializeCalled.toString()),new Error(tt);if(t&&t.length>0){let e=!1;for(let n=0;n<t.length;n++)if(t[n]===it.frameContext){e=!0;break}if(!e)throw new Error(`This call is only allowed in following contexts: ${JSON.stringify(t)}. Current context: "${it.frameContext}".`)}return Zn(e)}function Tr(e=Ve){const t=mn(it.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function Pr(){return it.hostClientType==tn.android||it.hostClientType==tn.ios||it.hostClientType==tn.ipados||it.hostClientType==tn.visionOS}function Or(e=Ve){if(!Pr()){throw{errorCode:Re.NOT_SUPPORTED_ON_PLATFORM}}if(!Tr(e)){throw{errorCode:Re.OLD_PLATFORM}}}function Rr(e){let t=it.additionalValidOrigins.concat(e.filter((e=>"string"==typeof e&&Xe.test(e))));const n={};t=t.filter((e=>!n[e]&&(n[e]=!0,!0))),it.additionalValidOrigins=t}function Fr(e){if(Mn(e))throw new Error(`Potential app id (${e}) is invalid; it contains script tags.`);if(!Nr(e))throw new Error(`Potential app id (${e}) is invalid; its length ${e.length} is not within the length limits (${kr}-${Mr}).`);if(xr(e))throw new Error(`Potential app id (${e}) is invalid; it contains non-printable characters.`)}const kr=4,Mr=256;function Nr(e){return e.length<Mr&&e.length>kr}function xr(e){return[...e].some((e=>{const t=e.charCodeAt(0);return t<32||t>126}))}function Lr(e){if(!(e instanceof Ur))throw new Error(`Potential app id (${e}) is invalid; it is not an instance of AppId class.`)}class Ur{constructor(e){this.appIdAsString=e,Fr(e)}serialize(){return this.toString()}toString(){return this.appIdAsString}}function Dr(e){return null==e}var Hr=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let Vr;const _r="v1",Br=jn("messageChannels.telemetry");function Wr(){return Hr(this,void 0,void 0,(function*(){if(Vr)return Br("Returning telemetry port from cache"),Vr;if(!jr())throw ln;return Vr=yield Gs(zn(_r,"messageChannels.telemetry.getTelemetryPort"),"messageChannels.telemetry.getTelemetryPort"),Vr}))}function jr(){var e;return!(!Ir(Xn)||!(null===(e=Xn.supports.messageChannels)||void 0===e?void 0:e.telemetry))}function zr(){Vr=void 0}var $r=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let qr;const Gr="v1",Jr=jn("messageChannels.dataLayer");function Kr(){return $r(this,void 0,void 0,(function*(){if(qr)return Jr("Returning dataLayer port from cache"),qr;if(!Qr())throw ln;return qr=yield Gs(zn(Gr,"messageChannels.dataLayer.getDataLayerPort"),"messageChannels.dataLayer.getDataLayerPort"),qr}))}function Qr(){var e;return!(!Ir(Xn)||!(null===(e=Xn.supports.messageChannels)||void 0===e?void 0:e.dataLayer))}function Zr(){qr=void 0}function Xr(e){if(!e)throw new Error("[app.lifecycle.registerBeforeSuspendOrTerminateHandler] Handler cannot be null");Ir(Xn),ds(e)}function Yr(e){if(!e)throw new Error("[app.lifecycle.registerOnResumeHandler] Handler cannot be null");Ir(Xn),fs(e)}const eo="v2",to=jn("app"),no={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"};var ro,oo;function io(){return it.initializeCompleted}function ao(){return it.frameContext}function so(e){return Ri(zn(eo,"app.initialize"),e)}function co(e){Ls.currentWindow=e}function lo(){it.initializeCalled&&(Ka(),it.initializeCalled=!1,it.initializeCompleted=!1,it.initializePromise=void 0,it.additionalValidOrigins=[],it.frameContext=void 0,it.hostClientType=void 0,it.isFramelessWindow=!1,zr(),Zr(),Hs())}function uo(){return new Promise((e=>{Ar(),e(Vs(zn(eo,"app.getContext"),"getContext"))})).then((e=>Co(e)))}function fo(){Ar(),Fi(zn(eo,"app.notifyAppLoaded"))}function po(){return Ni(zn(eo,"app.notifySuccess"))}function go(e){Ar(),Mi(zn(eo,"app.notifyFailure"),e)}function mo(e){Ar(),ki(zn(eo,"app.notifyExpectedFailure"),e)}function ho(e){Hi(zn(eo,"app.registerOnThemeChangeHandler"),e)}function vo(e){os(e)}function wo(e){return Vi(zn(eo,"app.openLink"),e)}function Co(e){var t;return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userClickTimeV2:e.userClickTimeV2,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:nn.teams,clientType:e.hostClientType?e.hostClientType:tn.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId,appId:e.appId?new Ur(e.appId):void 0,manifestVersion:e.manifestVersion},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:it.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,isBackgroundLoad:e.isBackgroundLoad,sourceOrigin:e.sourceOrigin},user:{id:null!==(t=e.userObjectId)&&void 0!==t?t:"",displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0,dialogParameters:e.dialogParameters||{}}}function yo(e){xo(zn(No,"dialog.update.resize"),e)}function bo(){return!(!Ir(Xn)||!Xn.supports.dialog)&&!!Xn.supports.dialog.update}function So(e,t,n){Uo(zn(No,"dialog.url.bot.open"),e,t,n)}function Eo(){return Ir(Xn)&&void 0!==(Xn.supports.dialog&&Xn.supports.dialog.url&&Xn.supports.dialog.url.bot)}function Ao(e){if(Ir(Xn,rn.task),!Po())throw ln;Qs(zn(No,"dialog.url.parentCommunication.sendMessageToParentFromDialog"),"messageForParent",[e])}function Io(e){if(Ir(Xn,rn.content,rn.sidePanel,rn.meetingStage),!Po())throw ln;Qs(zn(No,"dialog.url.parentCommunication.sendMessageToDialog"),"messageForChild",[e])}function To(e){if(Ir(Xn,rn.task),!Po())throw ln;for(Ya("messageForChild"),Xa(zn(No,"dialog.url.parentCommunication.registerMessageForChildHandler"),"messageForChild",e),_o.reverse();_o.length>0;){e(_o.pop())}}function Po(){var e,t;return Ir(Xn)&&!!(null===(t=null===(e=Xn.supports.dialog)||void 0===e?void 0:e.url)||void 0===t?void 0:t.parentCommunication)}function Oo(e,t,n){Lo(zn(No,"dialog.url.open"),e,t,n)}function Ro(e,t){Do(zn(No,"dialog.url.submit"),e,t)}function Fo(){return Ir(Xn)&&void 0!==(Xn.supports.dialog&&Xn.supports.dialog.url)}function ko(e){return{url:e.url,height:e.size?e.size.height:sn.Small,width:e.size?e.size.width:sn.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function Mo(e){const t=ko(e);return t.completionBotId=e.completionBotId,t}!function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(ro||(ro={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(oo||(oo={})),to("teamsjs instance is version %s, starting at %s UTC (%s local)",fr,(new Date).toISOString(),(new Date).toLocaleString()),function(){if(On())return;const e=document.getElementsByTagName("script"),t=e&&e[e.length-1]&&e[e.length-1].src,n="Today, teamsjs can only be used from a single script or you may see undefined behavior. This log line is used to help detect cases where teamsjs is loaded multiple times -- it is always written. The presence of the log itself does not indicate a multi-load situation, but multiples of these log lines will. If you would like to use teamjs from more than one script at the same time, please open an issue at https://github.com/OfficeDev/microsoft-teams-library-js/issues";t&&0!==t.length?to("teamsjs is being used from %s. %s",t,n):to("teamsjs is being used from a script tag embedded directly in your html. %s",n)}();const No="v2";function xo(e,t){if(Ir(Xn,rn.content,rn.sidePanel,rn.task,rn.meetingStage),!bo())throw ln;Qs(e,"tasks.updateTask",[t])}function Lo(e,t,n,r){if(Ir(Xn,rn.content,rn.sidePanel,rn.meetingStage),!Fo())throw ln;r&&Xa(zn(No,"dialog.url.registerMessageForParentHandler"),"messageForParent",r);Qs(e,"tasks.startTask",[ko(t)],((e,t)=>{null==n||n({err:e,result:t}),Ya("messageForParent")}))}function Uo(e,t,n,r){if(Ir(Xn,rn.content,rn.sidePanel,rn.meetingStage),!Eo())throw ln;r&&Xa(zn(No,"dialog.url.bot.registerMessageForParentHandler"),"messageForParent",r);Qs(e,"tasks.startTask",[Mo(t)],((e,t)=>{null==n||n({err:e,result:t}),Ya("messageForParent")}))}function Do(e,t,n){if(Ir(Xn,rn.task),!Fo())throw ln;Qs(e,"tasks.completeTask",[t,n?Array.isArray(n)?n:[n]:[]])}function Ho(e){return{card:e.card,height:e.size?e.size.height:sn.Small,width:e.size?e.size.width:sn.Small,title:e.title}}function Vo(e){const t=Ho(e);return t.completionBotId=e.completionBotId,t}const _o=[];function Bo(e){it.frameContext&&(it.frameContext===rn.task?_o.push(e):Ya("messageForChild"))}function Wo(e,t){if(Ir(Xn,rn.content,rn.sidePanel,rn.meetingStage),!jo())throw ln;const n=Vo(e);Qs(zn(No,"dialog.adaptiveCard.bot.open"),"tasks.startTask",[n],((e,n)=>{null==t||t({err:e,result:n})}))}function jo(){const e=Xn.hostVersionsInfo&&Xn.hostVersionsInfo.adaptiveCardSchemaVersion&&!En(Xn.hostVersionsInfo.adaptiveCardSchemaVersion);return Ir(Xn)&&void 0!==(e&&Xn.supports.dialog&&Xn.supports.dialog.card&&Xn.supports.dialog.card.bot)}function zo(e,t){if(Ir(Xn,rn.content,rn.sidePanel,rn.meetingStage),!$o())throw ln;const n=Ho(e);Qs(zn(No,"dialog.adaptiveCard.open"),"tasks.startTask",[n],((e,n)=>{null==t||t({err:e,result:n})}))}function $o(){const e=Xn.hostVersionsInfo&&Xn.hostVersionsInfo.adaptiveCardSchemaVersion&&!En(Xn.hostVersionsInfo.adaptiveCardSchemaVersion);return Ir(Xn)&&void 0!==(e&&Xn.supports.dialog&&Xn.supports.dialog.card)}function qo(){Xa(zn(No,"dialog.registerMessageForChildHandler"),"messageForChild",Bo,!1)}function Go(){return!(!Ir(Xn)||!Xn.supports.dialog)}const Jo="v2";var Ko,Qo;!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(Ko||(Ko={}));class Zo{constructor(){this.enabled=!0,this.selected=!1}}let Xo,Yo,ei,ti,ni;function ri(){Xa(zn(Jo,"menus.registerNavBarMenuItemPressHandler"),"navBarMenuItemPress",si,!1),Xa(zn(Jo,"menus.registerActionMenuItemPressHandler"),"actionMenuItemPress",li,!1),Xa(zn(Jo,"menus.registerSetModuleViewHandler"),"setModuleView",ii,!1)}function oi(e,t){if(Ir(Xn),!ui())throw ln;ei=t,Qs(zn(Jo,"menus.setUpViews"),"setUpViews",[e])}function ii(e){ei&&ei(e)||(Ir(Xn),Qs(zn(Jo,"menus.handleViewConfigItemPress"),"viewConfigItemPress",[e]))}function ai(e,t){if(Ir(Xn),!ui())throw ln;Xo=t,Qs(zn(Jo,"menus.setNavBarMenu"),"setNavBarMenu",[e])}function si(e){Xo&&Xo(e)||(Ir(Xn),Qs(zn(Jo,"menus.handleNavBarMenuItemPress"),"handleNavBarMenuItemPress",[e]))}function ci(e,t){if(Ir(Xn),!ui())throw ln;Yo=t,Qs(zn(Jo,"menus.showActionMenu"),"showActionMenu",[e])}function li(e){Yo&&Yo(e)||(Ir(Xn),Qs(zn(Jo,"menus.handleActionMenuItemPress"),"handleActionMenuItemPress",[e]))}function ui(){return!(!Ir(Xn)||!Xn.supports.menus)}function di(){Xa(zn(Ta,"pages.config.registerSettingsSaveHandler"),"settings.save",wi,!1),Xa(zn(Ta,"pages.config.registerSettingsRemoveHandler"),"settings.remove",bi,!1)}function fi(e){return La(zn(Ta,"pages.config.setValidityState"),e)}function pi(e){return Da(zn(Ta,"pages.config.setConfig"),e)}function gi(e){mi(zn(Ta,"pages.config.registerOnSaveHandler"),e,(()=>{if(!Dr(e)&&!Ei())throw ln}))}function mi(e,t,n){!Dr(t)&&Ir(Xn,rn.settings),n&&n(),ti=t,!Dr(t)&&Qs(e,"registerHandler",["save"])}function hi(e){vi(zn(Ta,"pages.config.registerOnRemoveHandler"),e,(()=>{if(!Dr(e)&&!Ei())throw ln}))}function vi(e,t,n){!Dr(t)&&Ir(Xn,rn.remove,rn.settings),n&&n(),ni=t,!Dr(t)&&Qs(e,"registerHandler",["remove"])}function wi(e){const t=new yi(e);ti?ti(t):vs()?As("settings.save",[e]):t.notifySuccess()}function Ci(e){ts(zn(Ta,"pages.config.registerChangeConfigHandler"),"changeSettings",e,[rn.content],(()=>{if(!Ei())throw ln}))}!function(e){e.dropDown="dropDown",e.popOver="popOver"}(Qo||(Qo={}));class yi{constructor(e){this.notified=!1,this.result=e||{}}notifySuccess(){this.ensureNotNotified(),Qs(zn(Ta,"pages.saveEvent.notifySuccess"),"settings.save.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),Qs(zn(Ta,"pages.saveEvent.notifyFailure"),"settings.save.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")}}function bi(){const e=new Si;ni?ni(e):vs()?As("settings.remove",[]):e.notifySuccess()}class Si{constructor(){this.notified=!1}notifySuccess(){this.ensureNotNotified(),Qs(zn(Ta,"pages.removeEvent.notifySuccess"),"settings.remove.success"),this.notified=!0}notifyFailure(e){this.ensureNotNotified(),Qs(zn(Ta,"pages.removeEvent.notifyFailure"),"settings.remove.failure",[e]),this.notified=!0}ensureNotNotified(){if(this.notified)throw new Error("The removeEventType may only notify success or failure once.")}}function Ei(){return!(!Ir(Xn)||!Xn.supports.pages)&&!!Xn.supports.pages.config}class Ai{}class Ii extends Ai{validate(e){return!0}deserialize(e){return e}}var Ti=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Pi=6e4,Oi=jn("app");function Ri(e,t){if(On()){return Oi.extend("initialize")("window object undefined at initialization"),Promise.resolve()}return bn((()=>Di(e,t)),Pi,new Error("SDK initialization timed out."))}function Fi(e){Qs(e,no.AppLoaded,[fr])}function ki(e,t){Qs(e,no.ExpectedFailure,[t.reason,t.message])}function Mi(e,t){Qs(e,no.Failure,[t.reason,t.message])}function Ni(e){return Ti(this,void 0,void 0,(function*(){if(it.initializeCompleted)return Li(e);if(!it.initializePromise)throw new Error(tt);return it.initializePromise.then((()=>Li(e)))}))}function xi(){var e;return Ir(Xn)&&!!(null===(e=Xn.supports.app)||void 0===e?void 0:e.notifySuccessResponse)}function Li(e){return Ti(this,void 0,void 0,(function*(){return xi()?$s(no.Success,[fr],new Ii,e).then((()=>({hasFinishedSuccessfully:!0}))):(Qs(e,no.Success,[fr]),{hasFinishedSuccessfully:"unknown"})}))}const Ui=Oi.extend("initializeHelper");function Di(e,t){return new Promise((n=>{it.initializeCalled||(it.initializeCalled=!0,Ja(),it.initializePromise=Ds(t,e).then((({context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r=Ve})=>{it.frameContext=e,it.hostClientType=t,it.clientSupportedSDKVersion=r;try{Ui("Parsing %s",n);const e=JSON.parse(n);if(Ui("Checking if %o is a valid runtime object",null!=e?e:"null"),!e||!e.apiVersion)throw new Error("Received runtime config is invalid");n&&ur(e)}catch(e){if(!(e instanceof SyntaxError))throw e;try{Ui("Attempting to parse %s as an SDK version",n),isNaN(mn(n,Ve))||(it.clientSupportedSDKVersion=n);const e=JSON.parse(r);if(Ui("givenRuntimeConfig parsed to %o",null!=e?e:"null"),!e)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");ur(e)}catch(e){if(!(e instanceof SyntaxError))throw e;ur(cr(it.clientSupportedSDKVersion,Yn,ir))}}it.initializeCompleted=!0})),ri(),di(),qo()),Array.isArray(t)&&Rr(t),void 0!==it.initializePromise?n(it.initializePromise):Ui("GlobalVars.initializePromise is unexpectedly undefined")}))}function Hi(e,t){!Dr(t)&&Ar(),ns(e,t)}function Vi(e,t){return new Promise((n=>{Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.task,rn.stage,rn.meetingStage),n(_s(e,"executeDeepLink",t))}))}var _i=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let Bi=[];const Wi=jn("validateOrigin");function ji(){return _i(this,void 0,void 0,(function*(){yield $i()}))}function zi(){return 0===Bi.length}function $i(e=!1){return _i(this,void 0,void 0,(function*(){if(!zi()&&!e)return Bi;if(On())return Bi=Ke,Ke;{Wi("Initiating fetch call to acquire valid origins list from CDN");const e=new AbortController,t=setTimeout((()=>e.abort()),Qe);return fetch(Ze,{signal:e.signal}).then((e=>{if(clearTimeout(t),!e.ok)throw new Error("Invalid Response from Fetch Call");return Wi("Fetch call completed and retrieved valid origins list from CDN"),e.json().then((e=>{if(qi(JSON.stringify(e)))return Bi=e.validOrigins,Bi;throw new Error("Valid origins list retrieved from CDN is invalid")}))})).catch((e=>("AbortError"===e.name?Wi(`validOrigins fetch call to CDN failed due to Timeout of ${Qe} ms. Defaulting to fallback list`):Wi("validOrigins fetch call to CDN failed with error: %s. Defaulting to fallback list",e),Bi=Ke,Bi)))}}))}function qi(e){let t=JSON.parse(e);try{t=JSON.parse(e)}catch(e){return!1}if(!t.validOrigins)return!1;for(const e of t.validOrigins)try{new URL("https://"+e)}catch(t){return Wi("isValidOriginsFromCDN call failed to validate origin: %s",e),!1}return!0}function Gi(e,t){if("*."===e.substring(0,2)){const n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}function Ji(e,t){return $i(t).then((t=>{if(!An(e))return Wi("Origin %s is invalid because it is not using https protocol. Protocol being used: %s",e,e.protocol),!1;const n=e.host;if(t.some((e=>Gi(e,n))))return!0;for(const e of it.additionalValidOrigins){if(Gi("https://"===e.substring(0,8)?e.substring(8):e,n))return!0}return Wi("Origin %s is invalid because it is not an origin approved by this library or included in the call to app.initialize.\nOrigins approved by this library: %o\nOrigins included in app.initialize: %o",e,t,it.additionalValidOrigins),!1}))}function Ki(e){ts(zn(Ta,"pages.appButton.onClick"),"appButtonClick",e,[rn.content],(()=>{if(!Xi())throw ln}))}function Qi(e){ts(zn(Ta,"pages.appButton.onHoverEnter"),"appButtonHoverEnter",e,[rn.content],(()=>{if(!Xi())throw ln}))}function Zi(e){ts(zn(Ta,"pages.appButton.onHoverLeave"),"appButtonHoverLeave",e,[rn.content],(()=>{if(!Xi())throw ln}))}function Xi(){return!(!Ir(Xn)||!Xn.supports.pages)&&!!Xn.supports.pages.appButton}function Yi(){ja()}function ea(){return Oa(zn(Ta,"pages.backStack.navigateBack"))}function ta(e){na(zn(Ta,"pages.backStack.registerBackButtonHandler"),e,(()=>{if(!Dr(e)&&!ra())throw ln}))}function na(e,t,n){!Dr(t)&&Ir(Xn),n&&n(),Wa(t),!Dr(t)&&Qs(e,"registerHandler",["backButton"])}function ra(){return!(!Ir(Xn)||!Xn.supports.pages)&&!!Xn.supports.pages.backStack}function oa(e){return new Promise((t=>{if(Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.task,rn.stage,rn.meetingStage),!aa())throw ln;t(Ws(zn(Ta,"pages.currentApp.navigateTo"),"pages.currentApp.navigateTo",e))}))}function ia(){return new Promise((e=>{if(Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.task,rn.stage,rn.meetingStage),!aa())throw ln;e(Ws(zn(Ta,"pages.currentApp.navigateToDefaultPage"),"pages.currentApp.navigateToDefaultPage"))}))}function aa(){return!(!Ir(Xn)||!Xn.supports.pages)&&!!Xn.supports.pages.currentApp}function sa(){if(Ir(Xn,rn.content),!la())throw ln;Qs(zn(Ta,"pages.fullTrust.enterFullscreen"),"enterFullscreen",[])}function ca(){if(Ir(Xn,rn.content),!la())throw ln;Qs(zn(Ta,"pages.fullTrust.exitFullscreen"),"exitFullscreen",[])}function la(){return!(!Ir(Xn)||!Xn.supports.pages)&&!!Xn.supports.pages.fullTrust}function ua(e){return Ra(zn(Ta,"pages.tabs.navigateToTab"),e)}function da(e){return ka(zn(Ta,"pages.tabs.getTabInstances"),e)}function fa(e){return Ma(zn(Ta,"pages.tabs.getMruTabInstances"),e)}function pa(){return!(!Ir(Xn)||!Xn.supports.pages)&&!!Xn.supports.pages.tabs}var ga,ma;function ha(e){const t=zn(Ta,"pages.returnFocus");if(Ir(Xn),!Ia())throw ln;if(void 0===e&&Qs(t,"returnFocus",[!1]),"boolean"==typeof e)Qs(t,"returnFocus",[e]);else switch(e){case ma.PreviousLandmark:case ma.GoToActivityFeed:Qs(t,"returnFocus",[!1,e]);break;case ma.NextLandmark:Qs(t,"returnFocus",[!0,e])}}function va(e){ts(zn(Ta,"pages.registerFocusEnterHandler"),"focusEnter",e,[],(()=>{if(!Ia())throw ln}))}function wa(e){xa(zn(Ta,"pages.setCurrentFrame"),e)}function Ca(e,t,n){ji(),Ri(zn(Ta,"pages.initializeWithFrameContext"),n).then((()=>t&&t())),wa(e)}function ya(){return Ua(zn(Ta,"pages.getConfig."))}function ba(e){return Pa(zn(Ta,"pages.navigateCrossDomain"),e)}function Sa(e){return new Promise((t=>{if(Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.task,rn.stage,rn.meetingStage),!Ia())throw ln;const n=zn(Ta,"pages.navigateToApp");if(Xn.isLegacyTeams){t(_s(n,"executeDeepLink",Sn(Ha(e)?e:Va(e))))}else{t(_s(n,"pages.navigateToApp",Ha(e)?_a(e):e))}}))}function Ea(e){return Na(zn(Ta,"pages.shareDeepLink"),e)}function Aa(e){ts(zn(Ta,"pages.registerFullScreenHandler"),"fullScreenChange",e,[],(()=>{if(!Dr(e)&&!Ia())throw ln}))}function Ia(){return!(!Ir(Xn)||!Xn.supports.pages)}ji(),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.Read=2]="Read",e[e.Compose=3]="Compose"}(ga||(ga={})),function(e){e[e.PreviousLandmark=0]="PreviousLandmark",e[e.NextLandmark=1]="NextLandmark",e[e.GoToActivityFeed=2]="GoToActivityFeed"}(ma||(ma={}));const Ta="v2";function Pa(e,t){return new Promise((n=>{if(Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.remove,rn.task,rn.stage,rn.meetingStage),!Ia())throw ln;n(Bs(e,"navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",t))}))}function Oa(e){return new Promise((t=>{if(Ir(Xn),!ra())throw ln;t(Bs(e,"navigateBack","Back navigation is not supported in the current client or context."))}))}function Ra(e,t){return new Promise((n=>{if(Ir(Xn),!pa())throw ln;n(Bs(e,"navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",t))}))}function Fa(e,t){if(Ir(Xn),!Ia())throw ln;Qs(e,"returnFocus",[t])}function ka(e,t){return new Promise((n=>{if(Ir(Xn),!pa())throw ln;n(Vs(e,"getTabInstances",t))}))}function Ma(e,t){return new Promise((n=>{if(Ir(Xn),!pa())throw ln;n(Vs(e,"getMruTabInstances",t))}))}function Na(e,t){if(Ir(Xn,rn.content,rn.sidePanel,rn.meetingStage),!Ia())throw ln;Qs(e,"shareDeepLink",[t.subPageId,t.subPageLabel,t.subPageWebUrl])}function xa(e,t){if(Ir(Xn,rn.content),!Ia())throw ln;Qs(e,"setFrameContext",[t])}function La(e,t){if(Ir(Xn,rn.settings,rn.remove),!Ei())throw ln;Qs(e,"settings.setValidityState",[t])}function Ua(e){return new Promise((t=>{if(Ir(Xn,rn.content,rn.settings,rn.remove,rn.sidePanel),!Ia())throw ln;t(Vs(e,"settings.getSettings"))}))}function Da(e,t){return new Promise((n=>{if(Ir(Xn,rn.content,rn.settings,rn.sidePanel),!Ei())throw ln;n(_s(e,"settings.setSettings",t))}))}function Ha(e){return e.appId instanceof Ur}function Va(e){return Object.assign(Object.assign({},e),{appId:new Ur(e.appId),webUrl:e.webUrl?new URL(e.webUrl):void 0})}function _a(e){return Object.assign(Object.assign({},e),{appId:e.appId.toString(),webUrl:e.webUrl?e.webUrl.toString():void 0})}let Ba;function Wa(e){Ba=e}function ja(){Xa(zn(Ta,"pages.backStack.registerBackButtonPressHandler"),"backButtonPress",za,!1)}function za(){Ba&&Ba()||(vs()?As("backButtonPress",[]):ea())}var $a=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const qa=jn("handlers");class Ga{static initializeHandlers(){Ga.handlers.themeChange=rs,Ga.handlers.load=ss,Ga.handlers.beforeUnload=us,ja()}static uninitializeHandlers(){Ga.handlers={},Ga.themeChangeHandler=null,Ga.loadHandler=null,Ga.beforeUnloadHandler=null,Ga.beforeSuspendOrTerminateHandler=null,Ga.resumeHandler=null}}function Ja(){Ga.initializeHandlers()}function Ka(){Ga.uninitializeHandlers()}Ga.handlers={},Ga.themeChangeHandler=null,Ga.loadHandler=null,Ga.beforeUnloadHandler=null,Ga.beforeSuspendOrTerminateHandler=null,Ga.resumeHandler=null,Ga.hostToAppPerformanceMetricsHandler=null;const Qa=qa.extend("callHandler");function Za(e,t){const n=Ga.handlers[e];if(n){Qa("Invoking the registered handler for message %s with arguments %o",e,t);return[!0,n.apply(this,t)]}return vs()?(As(e,t),[!1,void 0]):(Qa("Handler for action message %s not found.",e),[!1,void 0])}function Xa(e,t,n,r=!0,o=[]){n?(Ga.handlers[t]=n,r&&Qs(e,"registerHandler",[t,...o])):delete Ga.handlers[t]}function Ya(e){delete Ga.handlers[e]}function es(e){return null!=Ga.handlers[e]}function ts(e,t,n,r,o){n&&Ir(Xn,...r),o&&o(),Xa(e,t,n)}function ns(e,t){Ga.themeChangeHandler=t,!Dr(t)&&Qs(e,"registerHandler",["themeChange"])}function rs(e){Ga.themeChangeHandler&&Ga.themeChangeHandler(e),vs()&&As("themeChange",[e])}function os(e){Ga.hostToAppPerformanceMetricsHandler=e}function is(e){Ga.hostToAppPerformanceMetricsHandler&&Ga.hostToAppPerformanceMetricsHandler(e)}function as(e,t){Ga.loadHandler=t,!Dr(t)&&Qs(e,"registerHandler",["load"])}function ss(e){const t=cs(e);Ga.resumeHandler?(Ga.resumeHandler(t),vs()&&As("load",[t])):Ga.loadHandler&&(Ga.loadHandler(e),vs()&&As("load",[e]))}function cs(e){return{entityId:e.entityId,contentUrl:new URL(e.contentUrl)}}function ls(e,t){Ga.beforeUnloadHandler=t,!Dr(t)&&Qs(e,"registerHandler",["beforeUnload"])}function us(){return $a(this,void 0,void 0,(function*(){const e=()=>{Qs(zn("v2","handleBeforeUnload"),"readyToUnload",[])};Ga.beforeSuspendOrTerminateHandler?(yield Ga.beforeSuspendOrTerminateHandler(),vs()?As("beforeUnload"):e()):Ga.beforeUnloadHandler&&Ga.beforeUnloadHandler(e)||(vs()?As("beforeUnload"):e())}))}function ds(e){Ga.beforeSuspendOrTerminateHandler=e,!Dr(e)&&Qs(zn("v2","registerBeforeSuspendOrTerminateHandler"),"registerHandler",["beforeUnload"])}function fs(e){Ga.resumeHandler=e,!Dr(e)&&Qs(zn("v2","registerOnResumeHandler"),"registerHandler",["load"])}var ps=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const gs=jn("childProxyingCommunication");class ms{}function hs(){ms.window=null,ms.origin=null,ms.messageQueue=[]}function vs(){return!!ms.window}function ws(e,t){return ms.window&&!ms.window.closed&&e!==ms.window||(ms.window=e,ms.origin=t),ms.window&&ms.window.closed?(ms.window=null,ms.origin=null,!1):ms.window===e}function Cs(e,t,n,r){return ps(this,void 0,void 0,(function*(){ms.window===t&&(yr(ms.window,ms.origin,ms.messageQueue,"child"),bs(e,n,r))}))}ms.messageQueue=[];const ys=gs.extend("handleIncomingMessageFromChild");function bs(e,t,n){if(void 0===e.data.id||void 0===e.data.func)return;const r=mr(e.data),[o,i]=Za(r.func,r.args);if(o&&void 0!==i)return ys("Handler called in response to message %s from child. Returning response from handler to child, action: %s.",wr(r),r.func),void Es(r.id,r.uuid,Array.isArray(i)?i:[i]);ys("No handler for message %s from child found; relaying message on to parent, action: %s. Relayed message will have a new id.",wr(r),r.func),Ss(r,t,n)}function Ss(e,t,n){n(t(zn("v2","tasks.startTask"),e.func,e.args,!0).uuid,((...t)=>{if(ms.window){const n=t.pop();ys("Message from parent being relayed to child, id: %s",wr(e)),Es(e.id,e.uuid,t,n)}}))}function Es(e,t,n,r){const o=ms.window,i=Is(e,t,n,r),a=vr(i),s=ms.origin;o&&s&&(ys("Sending message %s to %s via postMessage, args = %o",wr(a),"child",a.args),o.postMessage(a,s))}function As(e,t){const n=ms.window,r=Ts(e,t),o=ms.origin;n&&o?n.postMessage(r,o):ms.messageQueue.push(r)}function Is(e,t,n,r){return{id:e,uuid:t,args:n||[],isPartialResponse:r}}function Ts(e,t){return{func:e,args:t||[]}}class Ps{static storeCallbackInformation(e,t){Ps.callbackInformation.set(e,t)}static clearMessages(){Ps.callbackInformation.clear()}static deleteMessageInformation(e){Ps.callbackInformation.delete(e)}static handleOneWayPerformanceMetrics(e,t,n){const r=e.monotonicTimestamp;r&&n?is({actionName:e.func,messageDelay:n-r,requestStartedAt:r}):t("Unable to send performance metrics for event %s",e.func)}static handlePerformanceMetrics(e,t,n,r){const o=Ps.callbackInformation.get(e);o&&t.monotonicTimestamp&&r?(is({actionName:o.name,messageDelay:r-t.monotonicTimestamp,requestStartedAt:o.calledAt}),Ps.deleteMessageInformation(e)):n("Unable to send performance metrics for callback %s with arguments %o",e.toString(),t.args)}}Ps.callbackInformation=new Map;const Os=jn("nestedAppAuthUtils"),Rs=Os.extend("tryPolyfillWithNestedAppAuthBridge");function Fs(e,t,n){var r;const o=Rs;if(it.isFramelessWindow)return void o("Cannot polyfill nestedAppAuthBridge as current window is frameless");if(!t)return void o("Cannot polyfill nestedAppAuthBridge as current window does not exist");const i=(()=>{try{return JSON.parse(e)}catch(e){return null}})();if(!i||!(null===(r=i.supports)||void 0===r?void 0:r.nestedAppAuth))return void o("Cannot polyfill nestedAppAuthBridge as current hub does not support nested app auth");const a=t;if(a.nestedAppAuthBridge)return void o("nestedAppAuthBridge already exists on current window, skipping polyfill");const s=Ms(a,n);s&&(a.nestedAppAuthBridge=s)}const ks=Os.extend("createNestedAppAuthBridge");function Ms(e,t){const n=ks;if(!e)return n("nestedAppAuthBridge cannot be created as current window does not exist"),null;const{onMessage:r,sendPostMessage:o}=t,i=e=>t=>r(t,e);return{addEventListener:(t,r)=>{"message"===t?e.addEventListener(t,i(r)):n(`Event ${t} is not supported by nestedAppAuthBridge`)},postMessage:e=>{const t=(()=>{try{return JSON.parse(e)}catch(e){return null}})();t&&"object"==typeof t&&"NestedAppAuthRequest"===t.messageType?o(e):n("Unrecognized data format received by app, message being ignored. Message: %o",e)},removeEventListener:(t,n)=>{e.removeEventListener(t,i(n))}}}var Ns=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const xs=jn("communication");class Ls{}class Us{}function Ds(e,t){if(Us.messageListener=e=>oc(e),Ls.currentWindow=Ls.currentWindow||Pn(),Ls.parentWindow=Ls.currentWindow.parent!==Ls.currentWindow.self?Ls.currentWindow.parent:Ls.currentWindow.opener,Ls.topWindow=Ls.currentWindow.top,(Ls.parentWindow||e)&&Ls.currentWindow.addEventListener("message",Us.messageListener,!1),!Ls.parentWindow){const e=Ls.currentWindow;if(!e.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));it.isFramelessWindow=!0,e.onNativeMessage=gc}try{return Ls.parentOrigin="*",js(t,"initialize",[fr,Jn,e]).then((([e,t,n,r])=>(Fs(r,Ls.currentWindow,{onMessage:ac,sendPostMessage:Xs}),{context:e,clientType:t,runtimeConfig:n,clientSupportedSDKVersion:r})))}finally{Ls.parentOrigin=null}}function Hs(){Ls.currentWindow&&Ls.currentWindow.removeEventListener("message",Us.messageListener,!1),Ls.currentWindow=null,Ls.parentWindow=null,Ls.parentOrigin=null,Us.parentMessageQueue=[],Us.nextMessageId=0,Us.callbacks.clear(),Us.promiseCallbacks.clear(),Us.portCallbacks.clear(),Us.legacyMessageIdsToUuidMap={},Ps.clearMessages(),hs()}function Vs(e,t,...n){return js(e,t,n).then((([e])=>e))}function _s(e,t,...n){return js(e,t,n).then((([e,t])=>{if(!e)throw new Error(t)}))}function Bs(e,t,n,...r){return js(e,t,r).then((([e,t])=>{if(!e)throw new Error(t||n)}))}function Ws(e,t,...n){return js(e,t,n).then((([e,t])=>{if(e)throw e;return t}))}function js(e,t,n=void 0){if(!$n(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return new Promise((r=>{r(Ks(nc(e,t,n).uuid))}))}function zs(e){return e.map((e=>dr(e)?e.serialize():e))}function $s(e,t,n,r,o){var i;return Ns(this,void 0,void 0,(function*(){const a=zs(t),[s]=yield js(r,e,a);if(o&&o(s)||!o&&De(s))throw new Error(`${s.errorCode}, message: ${null!==(i=s.message)&&void 0!==i?i:"None"}`);if(n.validate(s))return n.deserialize(s);throw new Error(`${Re.INTERNAL_ERROR}, message: Invalid response from host - ${JSON.stringify(s)}`)}))}function qs(e,t,n,r){var o;return Ns(this,void 0,void 0,(function*(){const i=zs(t),[a]=yield js(n,e,i);if(r&&r(a)||!r&&De(a))throw new Error(`${a.errorCode}, message: ${null!==(o=a.message)&&void 0!==o?o:"None"}`);if(void 0!==a)throw new Error(`${Re.INTERNAL_ERROR}, message: Invalid response from host`)}))}function Gs(e,t,n=void 0){if(!$n(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);return Js(nc(e,t,n).uuid)}function Js(e){return new Promise(((t,n)=>{Us.portCallbacks.set(e,((e,r)=>{e instanceof MessagePort?t(e):n(r&&r.length>0?r[0]:new Error("Host responded without port or error details."))}))}))}function Ks(e){return new Promise((t=>{Us.promiseCallbacks.set(e,t)}))}function Qs(e,t,n,r){let o;if(n instanceof Function?r=n:n instanceof Array&&(o=n),!$n(e))throw Error(`apiVersionTag: ${e} passed in doesn't follow the pattern starting with 'v' followed by digits, then underscore with words, please check.`);const i=nc(e,t,o);r&&Us.callbacks.set(i.uuid,r)}Us.parentMessageQueue=[],Us.topMessageQueue=[],Us.nextMessageId=0,Us.callbacks=new Map,Us.promiseCallbacks=new Map,Us.portCallbacks=new Map,Us.legacyMessageIdsToUuidMap={};const Zs=xs.extend("sendNestedAuthRequestToTopWindow");function Xs(e){const t=Zs,n=Ls.topWindow,r=Sc(e);return t("Message %s information: %o",wr(r),{actionName:r.func}),ec(n,r)}const Ys=xs.extend("sendRequestToTargetWindowHelper");function ec(e,t){const n=Ys,r=Cc(e),o=gr(t);if(it.isFramelessWindow)Ls.currentWindow&&Ls.currentWindow.nativeInterface&&(n("Sending message %s to %s via framelessPostMessage interface",wr(o),r),Ls.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(o)));else{const i=wc(e);e&&i?(n("Sending message %s to %s via postMessage",wr(o),r),e.postMessage(o,i)):(n("Adding message %s to %s message queue",wr(o),r),vc(e).push(t))}return t}const tc=xs.extend("sendMessageToParentHelper");function nc(e,t,n,r){const o=tc,i=Ls.parentWindow,a=bc(e,t,n,r);return Ps.storeCallbackInformation(a.uuid,{name:t,calledAt:a.timestamp}),o("Message %s information: %o",wr(a),{actionName:t,args:n}),ec(i,a)}const rc=xs.extend("processIncomingMessage");function oc(e){return Ns(this,void 0,void 0,(function*(){if(!e||!e.data||"object"!=typeof e.data)return void rc("Unrecognized message format received by app, message being ignored. Message: %o",e);const t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;return cc(t,n).then((r=>{r?(lc(t,n),t!==Ls.parentWindow?ws(t,n)&&Cs(e,t,nc,((e,t)=>Us.callbacks.set(e,t))):gc(e)):rc("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin, message: %o, source: %o, origin: %o",e,t,n)}))}))}const ic=xs.extend("processAuthBridgeMessage");function ac(e,t){var n,r;const o=ic;if(!e||!e.data||"object"!=typeof e.data)return void o("Unrecognized message format received by app, message being ignored. Message: %o",e);const{args:i}=e.data,[,a]=null!=i?i:[],s=(()=>{try{return JSON.parse(a)}catch(e){return null}})();if(!s||"object"!=typeof s||"NestedAppAuthResponse"!==s.messageType)return void o("Unrecognized data format received by app, message being ignored. Message: %o",e);const c=e.source||(null===(n=null==e?void 0:e.originalEvent)||void 0===n?void 0:n.source),l=e.origin||(null===(r=null==e?void 0:e.originalEvent)||void 0===r?void 0:r.origin);c?cc(c,l)?(Ls.topWindow&&!Ls.topWindow.closed&&c!==Ls.topWindow||(Ls.topWindow=c,Ls.topOrigin=l),Ls.topWindow&&Ls.topWindow.closed&&(Ls.topWindow=null,Ls.topOrigin=null),yr(Ls.topWindow,Ls.topOrigin,Us.topMessageQueue,"top"),t(a)):o("Message being ignored by app because it is either coming from the current window or a different window with an invalid origin"):o("Message being ignored by app because it is coming for a target that is null")}const sc=xs.extend("shouldProcessIncomingMessage");function cc(e,t){return Ns(this,void 0,void 0,(function*(){if(Ls.currentWindow&&e===Ls.currentWindow)return sc("Should not process message because it is coming from the current window"),!1;if(Ls.currentWindow&&Ls.currentWindow.location&&t&&t===Ls.currentWindow.location.origin)return!0;{let e;try{e=new URL(t)}catch(e){return sc("Message has an invalid origin of %s",t),!1}const n=yield Ji(e);return n||sc("Message has an invalid origin of %s",t),n}}))}function lc(e,t){it.isFramelessWindow||Ls.parentWindow&&!Ls.parentWindow.closed&&e!==Ls.parentWindow||(Ls.parentWindow=e,Ls.parentOrigin=t),Ls.parentWindow&&Ls.parentWindow.closed&&(Ls.parentWindow=null,Ls.parentOrigin=null),yr(Ls.parentWindow,Ls.parentOrigin,Us.parentMessageQueue,"parent")}const uc=xs.extend("handleIncomingMessageFromParent");function dc(e){const t=uc;if(!e.uuid)return Us.legacyMessageIdsToUuidMap[e.id];{const t=e.uuid,n=fc(Us.callbacks,t);if(n)return n;const r=fc(Us.promiseCallbacks,t);if(r)return r;const o=fc(Us.portCallbacks,t);if(o)return o}t("Received message %s that failed to produce a callbackId",wr(e))}function fc(e,t){if(t){const n=[...e].find((([e,n])=>e.toString()===t.toString()));if(n)return n[0]}}function pc(e,t){const n=fc(t,e.uuid);n&&t.delete(n),e.uuid?Us.legacyMessageIdsToUuidMap={}:delete Us.legacyMessageIdsToUuidMap[e.id]}function gc(e){const t=uc,n=Dn();if("id"in e.data&&"number"==typeof e.data.id){const r=e.data,o=hr(r),i=dc(o);if(i){const r=Us.callbacks.get(i);t("Received a response from parent for message %s",i.toString()),Ps.handlePerformanceMetrics(i,o,t,n),r&&(t("Invoking the registered callback for message %s with arguments %o",i.toString(),o.args),r.apply(null,[...o.args,o.isPartialResponse]),mc(e)||(t("Removing registered callback for message %s",i.toString()),pc(o,Us.callbacks)));const a=Us.promiseCallbacks.get(i);a&&(t("Invoking the registered promise callback for message %s with arguments %o",i.toString(),o.args),a(o.args),t("Removing registered promise callback for message %s",i.toString()),pc(o,Us.promiseCallbacks));const s=Us.portCallbacks.get(i);if(s){let n;t("Invoking the registered port callback for message %s with arguments %o",i.toString(),o.args),e.ports&&e.ports[0]instanceof MessagePort&&(n=e.ports[0]),s(n,o.args),t("Removing registered port callback for message %s",i.toString()),pc(o,Us.portCallbacks)}o.uuid&&(Us.legacyMessageIdsToUuidMap={})}}else if("func"in e.data&&"string"==typeof e.data.func){const r=e.data;Ps.handleOneWayPerformanceMetrics(r,t,n),t('Received a message from parent %s, action: "%s"',wr(r),r.func),Za(r.func,r.args)}else t("Received an unknown message: %O",e)}function mc(e){return!0===e.data.isPartialResponse}function hc(){return Ls.topWindow!==Ls.parentWindow}function vc(e){return e===Ls.topWindow&&hc()?Us.topMessageQueue:e===Ls.parentWindow?Us.parentMessageQueue:[]}function wc(e){return e===Ls.topWindow&&hc()?Ls.topOrigin:e===Ls.parentWindow?Ls.parentOrigin:null}function Cc(e){return e===Ls.topWindow&&hc()?"top":e===Ls.parentWindow?"parent":null}function yc(e,t){let n;n=Ls.currentWindow.setInterval((()=>{0===vc(e).length&&(clearInterval(n),t())}),100)}function bc(e,t,n,r){const o=Us.nextMessageId++,i=new Vn;return Us.legacyMessageIdsToUuidMap[o]=i,{id:o,uuid:i,func:t,timestamp:Date.now(),monotonicTimestamp:Dn(),args:n||[],apiVersionTag:e,isProxiedFromChild:null!=r&&r}}function Sc(e){const t=Us.nextMessageId++,n=new Vn;return Us.legacyMessageIdsToUuidMap[t]=n,{id:t,uuid:n,func:"nestedAppAuth.execute",timestamp:Date.now(),monotonicTimestamp:Dn(),args:[],data:e}}const Ec="v1";function Ac(e){if(!Dr(e)&&Ir(Xn),!Dr(e)&&!Ic())throw ln;e?Xa(zn(Ec,"log.request"),"log.request",(()=>{const t=e();Qs(zn(Ec,"log.receive"),"log.receive",[t])})):Ya("log.request")}function Ic(){return!(!Ir(Xn)||!Xn.supports.logs)}var Tc,Pc,Oc;!function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(Tc||(Tc={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(Pc||(Pc={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(Oc||(Oc={}));const Rc="v1";function Fc(e,t){Ir(Xn),Qs(zn(Rc,"uploadCustomApp"),"uploadCustomApp",[e],t||gn())}function kc(e,t,n){Ir(Xn),Qs(zn(Rc,"sendCustomMessage"),e,t,n)}function Mc(e,t){if(Ir(Xn),!vs())throw new Error("The child window has not yet been initialized or is not present");As(e,t)}function Nc(e,t){Ir(Xn),Xa(zn(Rc,"registerCustomHandler"),e,((...e)=>t.apply(this,e)))}function xc(e,t){Ir(Xn),Xa(zn(Rc,"registerUserSettingsChangeHandler"),"userSettingsChange",t,!0,[e])}function Lc(e){Ir(Xn,rn.content,rn.task);const t=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId,e.sizeInBytes];Qs(zn(Rc,"openFilePreview"),"openFilePreview",t)}const Uc="v1";function Dc(e){return new Promise((t=>{if(Ir(Xn,rn.content),!_c())throw ln;const n=_s(zn(Uc,"conversations.openConversation"),"conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&Xa(zn(Uc,"conversations.registerStartConversationHandler"),"startConversation",((t,n,r,o)=>{var i;return null===(i=e.onStartConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),e.onCloseConversation&&Xa(zn(Uc,"conversations.registerCloseConversationHandler"),"closeConversation",((t,n,r,o)=>{var i;return null===(i=e.onCloseConversation)||void 0===i?void 0:i.call(e,{subEntityId:t,conversationId:n,channelId:r,entityId:o})})),t(n)}))}function Hc(){if(Ir(Xn,rn.content),!_c())throw ln;Qs(zn(Uc,"conversations.closeConversation"),"conversations.closeConversation"),Ya("startConversation"),Ya("closeConversation")}function Vc(){return new Promise((e=>{if(Ir(Xn),!_c())throw ln;e(Vs(zn(Uc,"conversations.getChatMember"),"getChatMembers"))}))}function _c(){return!(!Ir(Xn)||!Xn.supports.conversations)}var Bc=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Wc="v2",jc=jn("copilot");function zc(){var e;return Ir(Xn)&&!!(null===(e=Xn.supports.copilot)||void 0===e?void 0:e.customTelemetry)}function $c(e,t){var n;return void 0===t&&(t=null!==(n=Dn())&&void 0!==n?n:Date.now()),Bc(this,void 0,void 0,(function*(){return Ir(Xn),jc("Sending custom telemetry data to host for stage: %s to record timestamp: %s",e,t),qs("copilot.customTelemetry.sendCustomTelemetryData",[e.toString(),t],zn(Wc,"copilot.customTelemetry.sendCustomTelemetryData"))}))}var qc=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Gc="v2",Jc=jn("copilot");function Kc(){var e,t;return Ir(Xn)&&(!!(null===(e=Xn.hostVersionsInfo)||void 0===e?void 0:e.appEligibilityInformation)||!!(null===(t=Xn.supports.copilot)||void 0===t?void 0:t.eligibility))}function Qc(){var e,t;return qc(this,void 0,void 0,(function*(){if(Ir(Xn),!Kc())throw new Error(`Error code: ${ln.errorCode}, message: Not supported on platform`);if(null===(e=Xn.hostVersionsInfo)||void 0===e?void 0:e.appEligibilityInformation)return Jc("Eligibility information is already available on runtime."),Xn.hostVersionsInfo.appEligibilityInformation;Jc("Eligibility information is not available on runtime. Requesting from host.");const n=yield Vs(zn(Gc,"copilot.eligibility.getEligibilityInfo"),"copilot.eligibility.getEligibilityInfo");if(De(n))throw new Error(`Error code: ${n.errorCode}, message: ${null!==(t=n.message)&&void 0!==t?t:"Failed to get eligibility information from the host."}`);if(!Zc(n))throw new Error("Error deserializing eligibility information");return n}))}function Zc(e){return void 0!==e.ageGroup&&void 0!==e.cohort&&void 0!==e.userClassification&&void 0!==e.isCopilotEligible&&void 0!==e.isCopilotEnabledRegion&&void 0!==e.isOptedOutByAdmin&&(!e.featureSet||void 0!==e.featureSet.serverFeatures&&void 0!==e.featureSet.uxFeatures)}const Xc="v2";class Yc{constructor(e){this.invokeRequest=e}serialize(){return this.invokeRequest}}function el(e){const t=e;return t.responseType===rl.ActionExecuteInvokeResponse&&void 0!==t.value&&void 0!==t.statusCode&&void 0!==t.type}const tl="Action.Execute";var nl,rl,ol;!function(e){e.ActionExecuteInvokeRequest="ActionExecuteInvokeRequest",e.QueryMessageExtensionRequest="QueryMessageExtensionRequest"}(nl||(nl={})),function(e){e.ActionExecuteInvokeResponse="ActionExecuteInvokeResponse",e.QueryMessageExtensionResponse="QueryMessageExtensionResponse"}(rl||(rl={}));class il extends Ai{validate(e){return el(e)}deserialize(e){return e}}function al(e){if("object"!=typeof e||null===e)return!1;const t=e;return Object.values(ol).includes(t.errorCode)&&(void 0===t.message||"string"==typeof t.message)}function sl(e){e.requestType===nl.ActionExecuteInvokeRequest?cl(e):e.requestType===nl.QueryMessageExtensionRequest&&ll(e)}function cl(e){if(e.type!==tl){throw{errorCode:ol.INTERNAL_ERROR,message:`Invalid action type ${e.type}. Action type must be "${tl}"`}}if(!Hn(e.data)){throw{errorCode:ol.INTERNAL_ERROR,message:`Invalid data type ${typeof e.data}. Data must be a primitive or a plain object.`}}}function ll(e){if(e.commandId.length>64)throw new Error("originalRequestInfo.commandId exceeds the maximum size of 64 characters");if(e.parameters.length>5)throw new Error("originalRequestInfo.parameters exceeds the maximum size of 5");for(const t of e.parameters){if(t.name.length>64)throw new Error("originalRequestInfo.parameters.name exceeds the maximum size of 64 characters");if(t.value.length>512)throw new Error("originalRequestInfo.parameters.value exceeds the maximum size of 512 characters")}}function ul(e,t,n){if(Ir(Xn,rn.content),!ml())throw ln;const r=new Ur(e);return sl(n),js(zn(Xc,"externalAppAuthentication.authenticateAndResendRequest"),"externalAppAuthentication.authenticateAndResendRequest",[r.toString(),n,t.url.href,t.width,t.height,t.isExternal]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))}function dl(e,t){if(Ir(Xn,rn.content),!ml())throw ln;const n=new Ur(e);return js(zn(Xc,"externalAppAuthentication.authenticateWithSSO"),"externalAppAuthentication.authenticateWithSSO",[n.toString(),t.claims,t.silent]).then((([e,t])=>{if(!e)throw t}))}function fl(e,t,n){if(Ir(Xn,rn.content),!ml())throw ln;const r=new Ur(e);return sl(n),js(zn(Xc,"externalAppAuthentication.authenticateWithSSOAndResendRequest"),"externalAppAuthentication.authenticateWithSSOAndResendRequest",[r.toString(),n,t.claims,t.silent]).then((([e,t])=>{if(e&&null!=t.responseType)return t;throw t}))}function pl(e,t,n){if(Ir(Xn,rn.content),!ml())throw ln;return Rn(e,new Error("titleId is Invalid.")),Rn(t,new Error("oauthConfigId is Invalid.")),js(zn(Xc,"externalAppAuthentication.authenticateWithOauth2"),"externalAppAuthentication.authenticateWithOauth2",[e,t,n.width,n.height,n.isExternal]).then((([e,t])=>{if(!e)throw t}))}function gl(e,t,n){if(Ir(Xn,rn.content),!ml())throw ln;return Rn(e,new Error("titleId is Invalid.")),t&&Fn(t),js(zn(Xc,"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins"),"externalAppAuthentication.authenticateWithPowerPlatformConnectorPlugins",[e,null==t?void 0:t.toString(),null==n?void 0:n.width,null==n?void 0:n.height,null==n?void 0:n.isExternal]).then((([e,t])=>{if(!e)throw t}))}function ml(){return!(!Ir(Xn)||!Xn.supports.externalAppAuthentication)}!function(e){e.INTERNAL_ERROR="INTERNAL_ERROR"}(ol||(ol={}));var hl=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const vl="v2";function wl(e,t,n){return hl(this,void 0,void 0,(function*(){if(Ir(Xn,rn.content),!Sl())throw ln;return El(e,t),qs("externalAppAuthenticationForCEA.authenticateWithSSO",[e,t,n.authId,n.connectionName,n.claims,n.silent],zn(vl,"externalAppAuthenticationForCEA.authenticateWithSSO"),al)}))}function Cl(e,t,n){return hl(this,void 0,void 0,(function*(){if(Ir(Xn,rn.content),!Sl())throw ln;return El(e,t),qs("externalAppAuthenticationForCEA.authenticateWithOauth",[e,t,n.url.href,n.width,n.height,n.isExternal],zn(vl,"externalAppAuthenticationForCEA.authenticateWithOauth"),al)}))}function yl(e,t,n,r){return hl(this,void 0,void 0,(function*(){if(Ir(Xn,rn.content),!Sl())throw ln;return El(e,t),cl(r),$s("externalAppAuthenticationForCEA.authenticateAndResendRequest",[e,t,new Yc(r),n.url.href,n.width,n.height,n.isExternal],new il,zn(vl,"externalAppAuthenticationForCEA.authenticateAndResendRequest"),al)}))}function bl(e,t,n,r){return hl(this,void 0,void 0,(function*(){if(Ir(Xn,rn.content),!Sl())throw ln;return El(e,t),cl(r),$s("externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest",[e,t,new Yc(r),n.authId,n.connectionName,n.claims,n.silent],new il,zn(vl,"externalAppAuthenticationForCEA.authenticateWithSSOAndResendRequest"),al)}))}function Sl(){return!(!Ir(Xn)||!Xn.supports.externalAppAuthenticationForCEA)}function El(e,t){Rn(t,new Error("conversation id is not valid.")),Lr(e)}const Al="v2";var Il,Tl;function Pl(e,t){if(Ir(Xn,rn.content),!Rl())throw ln;const n=new Ur(e);return js(zn(Al,"externalAppCardActions.processActionSubmit"),"externalAppCardActions.processActionSubmit",[n.toString(),t]).then((([e,t])=>{if(!e)throw t}))}function Ol(e,t,n){if(Ir(Xn,rn.content),!Rl())throw ln;const r=new Ur(e);return js(zn(Al,"externalAppCardActions.processActionOpenUrl"),"externalAppCardActions.processActionOpenUrl",[r.toString(),t.href,n]).then((([e,t])=>{if(e)throw e;return t}))}function Rl(){return!(!Ir(Xn)||!Xn.supports.externalAppCardActions)}!function(e){e.DeepLinkDialog="DeepLinkDialog",e.DeepLinkOther="DeepLinkOther",e.DeepLinkStageView="DeepLinkStageView",e.GenericUrl="GenericUrl"}(Il||(Il={})),function(e){e.INTERNAL_ERROR="INTERNAL_ERROR",e.INVALID_LINK="INVALID_LINK",e.NOT_SUPPORTED="NOT_SUPPORTED"}(Tl||(Tl={}));var Fl=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const kl="v2";function Ml(e,t,n){return Fl(this,void 0,void 0,(function*(){if(Ir(Xn,rn.content),!xl())throw ln;El(e,t);const[r,o]=yield js(zn(kl,"externalAppCardActionsForCEA.processActionOpenUrl"),"externalAppCardActionsForCEA.processActionOpenUrl",[e.toString(),t,n.href]);if(r)throw r;return o}))}function Nl(e,t,n){return Fl(this,void 0,void 0,(function*(){if(Ir(Xn,rn.content),!xl())throw ln;El(e,t);const r=yield Vs(zn(kl,"externalAppCardActionsForCEA.processActionSubmit"),"externalAppCardActionsForCEA.processActionSubmit",e.toString(),t,n);if(r)throw r}))}function xl(){return!(!Ir(Xn)||!Xn.supports.externalAppCardActionsForCEA)}var Ll=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Ul="v2";function Dl(e,t,n){return Ll(this,void 0,void 0,(function*(){if(Ir(Xn,rn.content),!Hl())throw ln;const r=new Ur(e),[o,i]=yield js(zn(Ul,"externalAppCommands.processActionCommand"),"externalAppCommands.processActionCommand",[r.toString(),t,n]);if(o)throw o;return i}))}function Hl(){return!(!Ir(Xn)||!Xn.supports.externalAppCommands)}const Vl="v1";var _l,Bl,Wl,jl,zl,$l;function ql(e,t){if(Ir(Xn,rn.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");Qs(zn(Vl,"files.getCloudStorageFolders"),"files.getCloudStorageFolders",[e],t)}function Gl(e,t){if(Ir(Xn,rn.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");Qs(zn(Vl,"files.addCloudStorageFolder"),"files.addCloudStorageFolder",[e],t)}function Jl(e,t,n){if(Ir(Xn,rn.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");Qs(zn(Vl,"files.deleteCloudStorageFolder"),"files.deleteCloudStorageFolder",[e,t],n)}function Kl(e,t,n){if(Ir(Xn,rn.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");Qs(zn(Vl,"files.getCloudStorageFolderContents"),"files.getCloudStorageFolderContents",[e,t],n)}function Ql(e,t,n){if(Ir(Xn,rn.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");Qs(zn(Vl,"files.openCloudStorageFile"),"files.openCloudStorageFile",[e,t,n])}function Zl(e=!1,t){if(Ir(Xn,rn.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");Qs(zn(Vl,"files.getExternalProviders"),"files.getExternalProviders",[e],t)}function Xl(e,t,n,r,o=!1,i){if(Ir(Xn,rn.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!i)throw new Error("[files.copyMoveFiles] callback cannot be null");Qs(zn(Vl,"files.copyMoveFiles"),"files.copyMoveFiles",[e,t,n,r,o],i)}function Yl(e){if(Ir(Xn,rn.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");Qs(zn(Vl,"files.getFileDownloads"),"files.getFileDownloads",[],e)}function eu(e=void 0,t){if(Ir(Xn,rn.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");Qs(zn(Vl,"files.openDownloadFolder"),"files.openDownloadFolder",[e],t)}function tu(e){if(Ir(Xn,rn.content),!e)throw uu(Re.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");Qs(zn(Vl,"files.addCloudStorageProvider"),"files.addCloudStorageProvider",[],e)}function nu(e,t){if(Ir(Xn,rn.content),!t)throw uu(Re.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw uu(Re.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");Qs(zn(Vl,"files.removeCloudStorageProvider"),"files.removeCloudStorageProvider",[e],t)}function ru(e,t){if(Ir(Xn,rn.content),!t)throw uu(Re.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw uu(Re.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");Qs(zn(Vl,"files.addCloudStorageProviderFile"),"files.addCloudStorageProviderFile",[e],t)}function ou(e,t){if(Ir(Xn,rn.content),!t)throw uu(Re.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw uu(Re.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");Qs(zn(Vl,"files.renameCloudStorageProviderFile"),"files.renameCloudStorageProviderFile",[e],t)}function iu(e,t){if(Ir(Xn,rn.content),!t)throw uu(Re.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw uu(Re.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Qs(zn(Vl,"files.deleteCloudStorageProviderFile"),"files.deleteCloudStorageProviderFile",[e],t)}function au(e,t){if(Ir(Xn,rn.content),!t)throw uu(Re.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw uu(Re.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");Qs(zn(Vl,"files.downloadCloudStorageProviderFile"),"files.downloadCloudStorageProviderFile",[e],t)}function su(e,t){if(Ir(Xn,rn.content),!t)throw uu(Re.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw uu(Re.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw uu(Re.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");Qs(zn(Vl,"files.uploadCloudStorageProviderFile"),"files.uploadCloudStorageProviderFile",[e],t)}function cu(e){if(Ir(Xn),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");Xa(zn(Vl,"files.registerCloudStorageProviderListChangeHandler"),"files.cloudStorageProviderListChange",e)}function lu(e){if(Ir(Xn),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");Xa(zn(Vl,"files.registerCloudStorageProviderContentChangeHandler"),"files.cloudStorageProviderContentChange",e)}function uu(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(_l||(_l={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(Bl||(Bl={})),function(e){e.ClassMaterials="classMaterials"}(Wl||(Wl={})),function(e){e.Readonly="readonly"}(jl||(jl={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(zl||(zl={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}($l||($l={}));const du="v1";function fu(){return new Promise((e=>{if(Ir(Xn),!hu())throw ln;e(Ws(zn(du,"meetingRoom.getPairedMeetingRoomInfo"),"meetingRoom.getPairedMeetingRoomInfo"))}))}function pu(e){return new Promise((t=>{if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(Ir(Xn),!hu())throw ln;t(Ws(zn(du,"meetingRoom.sendCommandToPairedMeetingRoom"),"meetingRoom.sendCommandToPairedMeetingRoom",e))}))}function gu(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(Ir(Xn),!hu())throw ln;Xa(zn(du,"meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler"),"meetingRoom.meetingRoomCapabilitiesUpdate",(t=>{Ir(Xn),e(t)}))}function mu(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(Ir(Xn),!hu())throw ln;Xa(zn(du,"meetingRoom.registerMeetingRoomStatesUpdateHandler"),"meetingRoom.meetingRoomStatesUpdate",(t=>{Ir(Xn),e(t)}))}function hu(){return!(!Ir(Xn)||!Xn.supports.meetingRoom)}function vu(){return!(!Ir(Xn)||!Xn.supports.messageChannels)}const wu="v1";function Cu(e){if(Ir(Xn,rn.content),!yu())throw ln;Qs(zn(wu,"notifications.showNotification"),"notifications.showNotification",[e])}function yu(){return!(!Ir(Xn)||!Xn.supports.notifications)}const bu="v2";function Su(e){if(!Iu())throw new Error(Re.NOT_SUPPORTED_ON_PLATFORM.toString());if(Dr(e))throw new Error(Re.INVALID_ARGUMENTS.toString());Xa(zn(bu,"otherApp.install"),"otherApp.install",e)}function Eu(){if(!Iu())throw new Error(Re.NOT_SUPPORTED_ON_PLATFORM.toString());Qs(zn(bu,"otherApp.unregisterInstall"),"otherApp.unregisterInstall"),Ya("otherApp.install")}function Au(e){if(!Iu())throw new Error(Re.NOT_SUPPORTED_ON_PLATFORM.toString());return qs("otherApp.notifyInstallCompleted",[e.toString()],zn(bu,"otherApp.notifyInstallCompleted"))}function Iu(){return!(!Ir(Xn)||!Xn.supports.otherAppStateChange)}const Tu="v1";var Pu,Ou,Ru;function Fu(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(Ir(Xn,rn.sidePanel),!Hu())throw ln;Qs(zn(Tu,"remoteCamera.getCapableParticipants"),"remoteCamera.getCapableParticipants",e)}function ku(e,t){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!t)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(Ir(Xn,rn.sidePanel),!Hu())throw ln;Qs(zn(Tu,"remoteCamera.requestControl"),"remoteCamera.requestControl",[e],t)}function Mu(e,t){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!t)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(Ir(Xn,rn.sidePanel),!Hu())throw ln;Qs(zn(Tu,"remoteCamera.sendControlCommand"),"remoteCamera.sendControlCommand",[e],t)}function Nu(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(Ir(Xn,rn.sidePanel),!Hu())throw ln;Qs(zn(Tu,"remoteCamera.terminateSession"),"remoteCamera.terminateSession",e)}function xu(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(Ir(Xn,rn.sidePanel),!Hu())throw ln;Xa(zn(Tu,"remoteCamera.registerOnCapableParticipantsChangeHandler"),"remoteCamera.capableParticipantsChange",e)}function Lu(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(Ir(Xn,rn.sidePanel),!Hu())throw ln;Xa(zn(Tu,"remoteCamera.registerOnErrorHandler"),"remoteCamera.handlerError",e)}function Uu(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(Ir(Xn,rn.sidePanel),!Hu())throw ln;Xa(zn(Tu,"remoteCamera.registerOnDeviceStateChangeHandler"),"remoteCamera.deviceStateChange",e)}function Du(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(Ir(Xn,rn.sidePanel),!Hu())throw ln;Xa(zn(Tu,"remoteCamera.registerOnSessionStatusChangeHandler"),"remoteCamera.sessionStatusChange",e)}function Hu(){return!(!Ir(Xn)||!Xn.supports.remoteCamera)}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(Pu||(Pu={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(Ou||(Ou={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(Ru||(Ru={}));const Vu="v1";function _u(e,t,n,r){if(Ir(Xn,rn.content),!Bu())throw ln;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!r)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");Qs(zn(Vu,"appEntity.selectAppEntity"),"appEntity.selectAppEntity",[e,t,n],r)}function Bu(){return!(!Ir(Xn)||!Xn.supports.appEntity)}const Wu="v1";function ju(e){return new Promise((t=>{if(Ir(Xn),!zu())throw ln;if((it.hostClientType===tn.android||it.hostClientType===tn.teamsRoomsAndroid||it.hostClientType===tn.teamsPhones||it.hostClientType===tn.teamsDisplays)&&!Tr(je)){const e={errorCode:Re.OLD_PLATFORM};throw new Error(JSON.stringify(e))}t(Vs(zn(Wu,"teams.fullTrust.joinedTeams.getUserJoinedTeams"),"getUserJoinedTeams",e))}))}function zu(){return!(!Ir(Xn)||!Xn.supports.teams)&&(!!Xn.supports.teams.fullTrust&&!!Xn.supports.teams.fullTrust.joinedTeams)}const $u="v1";function qu(e){return new Promise((t=>{if(Ir(Xn),!Gu())throw ln;t(Vs(zn($u,"teams.fullTrust.getConfigSetting"),"getConfigSetting",e))}))}function Gu(){return!(!Ir(Xn)||!Xn.supports.teams)&&!!Xn.supports.teams.fullTrust}const Ju="v1";var Ku;function Qu(e,t){if(Ir(Xn,rn.content),!Xu())throw ln;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!t)throw new Error("[teams.getTeamChannels] Callback cannot be null");Qs(zn(Ju,"teams.getTeamChannels"),"teams.getTeamChannels",[e],t)}function Zu(e,t){if(Ir(Xn),!Xu())throw ln;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!t)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");Qs(zn(Ju,"teams.refreshSiteUrl"),"teams.refreshSiteUrl",[e],t)}function Xu(){return!(!Ir(Xn)||!Xn.supports.teams)}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(Ku||(Ku={}));class Yu{static setTimeout(e,t){const n=performance.now(),r=hn();return Yu.setTimeoutCallbacks[r]={callback:e,timeoutInMs:t,startedAtInMs:n},r}static clearTimeout(e){delete Yu.setTimeoutCallbacks[e]}static setInterval(e,t){Yu.setTimeout((function n(){e(),Yu.setTimeout(n,t)}),t)}static tick(){const e=performance.now(),t=[];for(const n in Yu.setTimeoutCallbacks){const r=Yu.setTimeoutCallbacks[n];e-r.startedAtInMs>=r.timeoutInMs&&t.push(n)}for(const e of t){Yu.setTimeoutCallbacks[e].callback(),delete Yu.setTimeoutCallbacks[e]}}}Yu.setTimeoutCallbacks={};class ed{constructor(e,t){this.reportStatisticsResult=t,this.sampleCount=0,this.distributionBins=new Uint32Array(e)}processStarts(e,t,n,r){Yu.tick(),this.suitableForThisSession(e,t,n,r)||this.reportAndResetSession(this.getStatistics(),e,r,t,n),this.start()}processEnds(){const e=performance.now()-this.frameProcessingStartedAt,t=Math.floor(Math.max(0,Math.min(this.distributionBins.length-1,e)));this.distributionBins[t]+=1,this.sampleCount+=1}getStatistics(){return this.currentSession?{effectId:this.currentSession.effectId,effectParam:this.currentSession.effectParam,frameHeight:this.currentSession.frameHeight,frameWidth:this.currentSession.frameWidth,duration:performance.now()-this.currentSession.startedAtInMs,sampleCount:this.sampleCount,distributionBins:this.distributionBins.slice()}:null}start(){this.frameProcessingStartedAt=performance.now()}suitableForThisSession(e,t,n,r){return this.currentSession&&this.currentSession.effectId===e&&this.currentSession.effectParam===r&&this.currentSession.frameWidth===t&&this.currentSession.frameHeight===n}reportAndResetSession(e,t,n,r,o){e&&this.reportStatisticsResult(e),this.resetCurrentSession(this.getNextTimeout(t,this.currentSession),t,n,r,o),this.timeoutId&&Yu.clearTimeout(this.timeoutId),this.timeoutId=Yu.setTimeout((()=>this.reportAndResetSession(this.getStatistics(),t,n,r,o)).bind(this),this.currentSession.timeoutInMs)}resetCurrentSession(e,t,n,r,o){this.currentSession={startedAtInMs:performance.now(),timeoutInMs:e,effectId:t,effectParam:n,frameWidth:r,frameHeight:o},this.sampleCount=0,this.distributionBins.fill(0)}getNextTimeout(e,t){return t&&t.effectId===e?Math.min(ed.maxSessionTimeoutInMs,2*t.timeoutInMs):ed.initialSessionTimeoutInMs}}ed.initialSessionTimeoutInMs=1e3,ed.maxSessionTimeoutInMs=3e4;const td="v2";class nd{constructor(e){this.reportPerformanceEvent=e,this.isFirstFrameProcessed=!1,this.frameProcessTimeLimit=100,this.frameProcessingStartedAt=0,this.frameProcessingTimeCost=0,this.processedFrameCount=0,this.performanceStatistics=new ed(nd.distributionBinSize,(e=>this.reportPerformanceEvent(zn(td,"videoPerformanceMonitor.performanceDataGenerated"),"video.performance.performanceDataGenerated",[e])))}startMonitorSlowFrameProcessing(){Yu.setInterval((()=>{if(0===this.processedFrameCount)return;const e=this.frameProcessingTimeCost/this.processedFrameCount;e>this.frameProcessTimeLimit&&this.reportPerformanceEvent(zn(td,"videoPerformanceMonitor.startMonitorSlowFrameProcessing"),"video.performance.frameProcessingSlow",[e]),this.frameProcessingTimeCost=0,this.processedFrameCount=0}),nd.calculateFPSInterval)}setFrameProcessTimeLimit(e){this.frameProcessTimeLimit=e}reportApplyingVideoEffect(e,t){var n,r;(null===(n=this.applyingEffect)||void 0===n?void 0:n.effectId)===e&&(null===(r=this.applyingEffect)||void 0===r?void 0:r.effectParam)===t||(this.applyingEffect={effectId:e,effectParam:t},this.appliedEffect=void 0)}reportVideoEffectChanged(e,t){void 0===this.applyingEffect||this.applyingEffect.effectId!==e&&this.applyingEffect.effectParam!==t||(this.appliedEffect={effectId:e,effectParam:t},this.applyingEffect=void 0,this.isFirstFrameProcessed=!1)}reportStartFrameProcessing(e,t){Yu.tick(),this.appliedEffect&&(this.frameProcessingStartedAt=performance.now(),this.performanceStatistics.processStarts(this.appliedEffect.effectId,e,t,this.appliedEffect.effectParam))}reportFrameProcessed(){var e;this.appliedEffect&&(this.processedFrameCount++,this.frameProcessingTimeCost+=performance.now()-this.frameProcessingStartedAt,this.performanceStatistics.processEnds(),this.isFirstFrameProcessed||(this.isFirstFrameProcessed=!0,this.reportPerformanceEvent(zn(td,"videoPerformanceMonitor.reportFrameProcessed"),"video.performance.firstFrameProcessed",[Date.now(),this.appliedEffect.effectId,null===(e=this.appliedEffect)||void 0===e?void 0:e.effectParam])))}reportGettingTextureStream(e){this.gettingTextureStreamStartedAt=performance.now(),this.currentStreamId=e}reportTextureStreamAcquired(){if(void 0!==this.gettingTextureStreamStartedAt){const e=performance.now()-this.gettingTextureStreamStartedAt;this.reportPerformanceEvent(zn(td,"videoPerformanceMonitor.reportTextureStreamAcquired"),"video.performance.textureStreamAcquired",[this.currentStreamId,e])}}}nd.distributionBinSize=1e3,nd.calculateFPSInterval=1e3;var rd=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))},od=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const id="v2",ad=On()?void 0:new nd(Qs);var sd,cd,ld;function ud(e){if(Ir(Xn,rn.sidePanel),!md())throw ln;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Xa(zn(id,"videoEffects.setFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(e=>null==ad?void 0:ad.setFrameProcessTimeLimit(e.timeLimit)),!1),yd())hd(e.videoFrameHandler,e.config);else{if(!Sd())throw ln;wd(e.videoBufferHandler,e.config)}null==ad||ad.startMonitorSlowFrameProcessing()}function dd(e,t){if(Ir(Xn,rn.sidePanel),!md())throw ln;Qs(zn(id,"videoEffects.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t])}function fd(e){if(Ir(Xn,rn.sidePanel),!md())throw ln;Xa(zn(id,"videoEffects.registerEffectParameterChangeHandler"),"video.effectParameterChange",xd(e,ad),!1),Qs(zn(id,"videoEffects.registerForVideoEffect"),"video.registerForVideoEffect")}function pd(e){Qs(zn(id,"videoEffects.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function gd(e){Qs(zn(id,"videoEffects.notifyError"),"video.notifyError",[e])}function md(){return Ir(Xn)&&!!Xn.supports.video&&(!!Xn.supports.video.mediaStream||!!Xn.supports.video.sharedFrame)}function hd(e,t){if(Ir(Xn,rn.sidePanel),!md()||!yd())throw ln;Xa(zn(id,"videoEffects.startVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(t=>rd(this,void 0,void 0,(function*(){const{streamId:n}=t,r=vd(e,ad);yield Id(n,r,gd,ad)}))),!1),Qs(zn(id,"videoEffects.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[t])}function vd(e,t){return n=>rd(this,void 0,void 0,(function*(){const r=n.videoFrame;null==t||t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);const o=yield e(n);return null==t||t.reportFrameProcessed(),o}))}function wd(e,t){if(Ir(Xn,rn.sidePanel),!md()||!Sd())throw ln;Xa(zn(id,"videoEffects.registerForVideoBufferHandler"),"video.newVideoFrame",(t=>{if(t){const n=t.timestamp;null==ad||ad.reportStartFrameProcessing(t.width,t.height),e(Cd(t),(()=>{null==ad||ad.reportFrameProcessed(),pd(n)}),gd)}}),!1),Qs(zn(id,"videoEffects.registerForVideoFrame"),"video.registerForVideoFrame",[t])}function Cd(e){if("videoFrameBuffer"in e)return e;{const{data:t}=e,n=od(e,["data"]);return Object.assign(Object.assign({},n),{videoFrameBuffer:t})}}function yd(){var e;return Ir(Xn,rn.sidePanel)&&bd()&&!!(null===(e=Xn.supports.video)||void 0===e?void 0:e.mediaStream)}function bd(){var e,t,n,r;return!(!(null===(t=null===(e=Pn().chrome)||void 0===e?void 0:e.webview)||void 0===t?void 0:t.getTextureStream)||!(null===(r=null===(n=Pn().chrome)||void 0===n?void 0:n.webview)||void 0===r?void 0:r.registerTextureStream))}function Sd(){var e;return Ir(Xn,rn.sidePanel)&&!!(null===(e=Xn.supports.video)||void 0===e?void 0:e.sharedFrame)}!function(e){e.NV12="NV12"}(sd||(sd={})),function(e){e.EffectChanged="EffectChanged",e.EffectDisabled="EffectDisabled"}(cd||(cd={})),function(e){e.InvalidEffectId="InvalidEffectId",e.InitializationFailure="InitializationFailure"}(ld||(ld={}));var Ed=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Ad="v2";function Id(e,t,n,r){var o,i;return Ed(this,void 0,void 0,(function*(){const a=Od();!On()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),Rd(yield Pd(e,n,r),new Fd(n,t),a.writable)}))}function Td(e,t,n,r){var o,i;return Ed(this,void 0,void 0,(function*(){const a=Od();!On()&&(null===(i=null===(o=window.chrome)||void 0===o?void 0:o.webview)||void 0===i||i.registerTextureStream(e,a)),Rd(yield Pd(e,n,r),new Nd(n,t),a.writable)}))}function Pd(e,t,n){return Ed(this,void 0,void 0,(function*(){if(On())throw ln;const r=Pn().chrome;try{null==n||n.reportGettingTextureStream(e);const t=(yield r.webview.getTextureStream(e)).getVideoTracks();if(0===t.length)throw new Error(`No video track in stream ${e}`);return null==n||n.reportTextureStreamAcquired(),t[0]}catch(n){throw t(`Failed to get video track from stream ${e}, error: ${n}`),new Error(`Internal error: can't get video track from stream ${e}`)}}))}function Od(){if(On())throw ln;const e=window.MediaStreamTrackGenerator;if(!e)throw ln;return new e({kind:"video"})}function Rd(e,t,n){new(0,Pn().MediaStreamTrackProcessor)({track:e}).readable.pipeThrough(new TransformStream(t)).pipeTo(n)}class Fd{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.transform=(e,t)=>Ed(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const r=yield this.videoFrameHandler({videoFrame:e}),o=new VideoFrame(r,{timestamp:n});t.enqueue(o),e.close(),r.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")}))}}class kd{constructor(e,t){if(this.headerBuffer=e,this.notifyError=t,this.ONE_TEXTURE_INPUT_ID=1869900081,this.INVALID_HEADER_ERROR="Invalid video frame header",this.UNSUPPORTED_LAYOUT_ERROR="Unsupported texture layout",this.headerDataView=new Uint32Array(e),this.headerDataView.length<8)throw this.notifyError(this.INVALID_HEADER_ERROR),new Error(this.INVALID_HEADER_ERROR);if(this.headerDataView[0]!==this.ONE_TEXTURE_INPUT_ID)throw this.notifyError(this.UNSUPPORTED_LAYOUT_ERROR),new Error(this.UNSUPPORTED_LAYOUT_ERROR)}get oneTextureLayoutId(){return this.headerDataView[0]}get version(){return this.headerDataView[1]}get frameRowOffset(){return this.headerDataView[2]}get frameFormat(){return this.headerDataView[3]}get frameWidth(){return this.headerDataView[4]}get frameHeight(){return this.headerDataView[5]}get multiStreamHeaderRowOffset(){return this.headerDataView[6]}get multiStreamCount(){return this.headerDataView[7]}}class Md{constructor(e,t){this.metadataMap=new Map,this.AUDIO_INFERENCE_RESULT_STREAM_ID=828664161,this.ATTRIBUTE_ID_MAP_STREAM_ID=1296320833;const n=new Uint32Array(e);for(let r=0,o=0;r<t;r++){const t=n[o++],r=n[o++],i=n[o++],a=new Uint8Array(e,r,i);this.metadataMap.set(t,a)}}get audioInferenceResult(){return this.metadataMap.get(this.AUDIO_INFERENCE_RESULT_STREAM_ID)}get attributes(){const e=this.metadataMap.get(this.ATTRIBUTE_ID_MAP_STREAM_ID);if(void 0===e)return;const t=new Map,n=new TextDecoder("utf-8");let r=0;const o=e[r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24);for(let i=0;i<o&&r<e.length-1;i++){const o=e[++r]+(e[++r]<<8)+(e[++r]<<16)+(e[++r]<<24),i=e.findIndex(((e,t,n)=>0==e&&t>r)),a=n.decode(e.slice(++r,i)),s=this.metadataMap.get(o);void 0!==s&&t.set(a,s);r=i+(4-(i-r)%4-1)}return t}}class Nd{constructor(e,t){this.notifyError=e,this.videoFrameHandler=t,this.shouldDiscardAudioInferenceResult=!1,this.transform=(e,t)=>Ed(this,void 0,void 0,(function*(){const n=e.timestamp;if(null!==n)try{const{videoFrame:r,metadata:{audioInferenceResult:o,attributes:i}={}}=yield this.extractVideoFrameAndMetadata(e),a=yield this.videoFrameHandler({videoFrame:r,audioInferenceResult:o,attributes:i}),s=new VideoFrame(a,{timestamp:n});t.enqueue(s),r.close(),e.close(),a.close()}catch(t){e.close(),this.notifyError(t)}else this.notifyError("timestamp of the original video frame is null")})),this.extractVideoFrameAndMetadata=e=>Ed(this,void 0,void 0,(function*(){if(On())throw ln;if("NV12"!==e.format)throw this.notifyError("Unsupported video frame pixel format"),new Error("Unsupported video frame pixel format");const t={x:0,y:0,width:e.codedWidth,height:2},n=new ArrayBuffer(t.width*t.height*3/2);yield e.copyTo(n,{rect:t});const r=new kd(n,this.notifyError),o={x:0,y:r.multiStreamHeaderRowOffset,width:e.codedWidth,height:e.codedHeight-r.multiStreamHeaderRowOffset},i=new ArrayBuffer(o.width*o.height*3/2);yield e.copyTo(i,{rect:o});const a=new Md(i,r.multiStreamCount);return{videoFrame:new VideoFrame(e,{timestamp:e.timestamp,visibleRect:{x:0,y:r.frameRowOffset,width:r.frameWidth,height:r.frameHeight}}),metadata:{audioInferenceResult:this.shouldDiscardAudioInferenceResult?void 0:a.audioInferenceResult,attributes:a.attributes}}})),Xa(zn(Ad,"videoEffectsUtils.transformerWithMetadata.constructor"),"video.mediaStream.audioInferenceDiscardStatusChange",(({discardAudioInferenceResult:e})=>{this.shouldDiscardAudioInferenceResult=e}))}}function xd(e,t){return(n,r)=>{null==t||t.reportApplyingVideoEffect(n||"",r),e(n,r).then((()=>{null==t||t.reportVideoEffectChanged(n||"",r),Qs(zn(Ad,"videoEffectsUtils.reportVideoEffectChanged"),"video.videoEffectReadiness",[!0,n,void 0,r])})).catch((e=>{const t=e in ld?e:ld.InitializationFailure;Qs(zn(Ad,"videoEffectsUtils.effectFailure"),"video.videoEffectReadiness",[!1,n,t,r])}))}}var Ld=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Ud="v2",Dd=2e3,Hd=On()?void 0:new nd(Qs);var Vd;function _d(e){var t,n;if(!Gd())throw ln;if(!e.videoFrameHandler||!e.videoBufferHandler)throw new Error("Both videoFrameHandler and videoBufferHandler must be provided");if(Ir(Xn,rn.sidePanel)){if(Xa(zn(Ud,"videoEffectsEX.registerSetFrameProcessTimeLimitHandler"),"video.setFrameProcessTimeLimit",(e=>null==Hd?void 0:Hd.setFrameProcessTimeLimit(e)),!1),null===(t=Xn.supports.video)||void 0===t?void 0:t.mediaStream)Xa(zn(Ud,"videoEffectsEX.registerStartVideoExtensibilityVideoStreamHandler"),"video.startVideoExtensibilityVideoStream",(t=>Ld(this,void 0,void 0,(function*(){const{streamId:n,metadataInTexture:r}=t,o=Hd?Wd(e.videoFrameHandler,Hd):e.videoFrameHandler;r?yield Td(n,o,Kd,Hd):yield Id(n,o,Kd,Hd)}))),!1),Qs(zn(Ud,"videoEffectsEX.mediaStream.registerForVideoFrame"),"video.mediaStream.registerForVideoFrame",[e.config]);else{if(!(null===(n=Xn.supports.video)||void 0===n?void 0:n.sharedFrame))throw ln;Xa(zn(Ud,"videoEffectsEx.registerNewVideoFrameHandler"),"video.newVideoFrame",(t=>{if(t){null==Hd||Hd.reportStartFrameProcessing(t.width,t.height);const n=Bd(),r=t.timestamp;e.videoBufferHandler(jd(t),(()=>{n(),null==Hd||Hd.reportFrameProcessed(),Jd(r)}),Kd)}}),!1),Qs(zn(Ud,"videoEffectsEx.registerForVideoFrame"),"video.registerForVideoFrame",[e.config])}null==Hd||Hd.startMonitorSlowFrameProcessing()}}function Bd(){const e=setTimeout((()=>{Kd(`Frame not processed in ${Dd}ms`,Vd.Warn)}),Dd);return function(){clearTimeout(e)}}function Wd(e,t){return n=>Ld(this,void 0,void 0,(function*(){const r=n.videoFrame;t.reportStartFrameProcessing(r.codedWidth,r.codedHeight);const o=Bd(),i=yield e(n);return o(),t.reportFrameProcessed(),i}))}function jd(e){return e.videoFrameBuffer=e.videoFrameBuffer||e.data,delete e.data,e}function zd(e,t,n){if(Ir(Xn,rn.sidePanel),!Gd())throw ln;Qs(zn(Ud,"videoEffectsEx.notifySelectedVideoEffectChanged"),"video.videoEffectChanged",[e,t,n])}function $d(e){if(Ir(Xn,rn.sidePanel),!Gd())throw ln;Xa(zn(Ud,"videoEffectsEx.registerEffectParamterChangeHandler"),"video.effectParameterChange",xd(e,Hd),!1),Qs(zn(Ud,"videoEffectsEx.registerForVideoEffect"),"video.registerForVideoEffect")}function qd(e){if(Ir(Xn,rn.sidePanel),!md())throw ln;Qs(zn(Ud,"videoEffectsEx.updatePersonalizedEffects"),"video.personalizedEffectsChanged",[e])}function Gd(){return Ir(Xn),md()}function Jd(e){Qs(zn(Ud,"videoEffectsEx.notifyVideoFrameProcessed"),"video.videoFrameProcessed",[e])}function Kd(e,t=Vd.Warn){Qs(zn(Ud,"videoEffectsEx.notifyError"),"video.notifyError",[e,t])}function Qd(e){if(Ir(Xn),!md())throw ln;Kd(e,Vd.Fatal)}!function(e){e.Fatal="fatal",e.Warn="warn"}(Vd||(Vd={}));const Zd="v2";class Xd extends Ai{validate(e){return"ConfigurableTab"===e.tabType}deserialize(e){return e}}class Yd{constructor(e){this.configurableTabInstance=e}serialize(){return this.configurableTabInstance}}class ef{constructor(e){this.hostEntityId=e}serialize(){return this.hostEntityId}}class tf extends Ai{validate(e){return"ConfigurableTab"===e.tabType||"StaticTab"===e.tabType}deserialize(e){return e}}class nf{constructor(e){this.hostEntityTabInstance=e}serialize(){return this.hostEntityTabInstance}}class rf extends Ai{validate(e){const t=new tf;let n=!0;return e.allTabs&&e.allTabs.forEach((e=>{n||(n=t.validate(e))})),n}deserialize(e){return e}}function of(e,t){if(Ir(Xn),!uf())throw new Error(`Error code: ${Re.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);if(df(e.threadId),t&&0===t.length)throw new Error(`Error code: ${Re.INVALID_ARGUMENTS}, message: App types cannot be an empty array`);return $s("hostEntity.tab.addAndConfigure",[new ef(e),t],new tf,zn(Zd,"hostEntity.tab.addAndConfigure"))}function af(e){if(Ir(Xn),!uf())throw new Error(`Error code: ${Re.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return df(e.threadId),$s("hostEntity.tab.getAll",[new ef(e)],new rf,zn(Zd,"hostEntity.tab.getAll"))}function sf(e,t){if(Ir(Xn),!uf())throw new Error(`Error code: ${Re.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return ff(e),df(t.threadId),$s("hostEntity.tab.reconfigure",[new Yd(e),new ef(t)],new Xd,zn(Zd,"hostEntity.tab.reconfigure"))}function cf(e,t){if(Ir(Xn),!uf())throw new Error(`Error code: ${Re.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return ff(e),df(t.threadId),$s("hostEntity.tab.rename",[new Yd(e),new ef(t)],new Xd,zn(Zd,"hostEntity.tab.rename"))}function lf(e,t){if(Ir(Xn),!uf())throw new Error(`Error code: ${Re.NOT_SUPPORTED_ON_PLATFORM}, message: Not supported on platform`);return df(t.threadId),ff(e),$s("hostEntity.tab.remove",[new nf(e),new ef(t)],new Ii,zn(Zd,"hostEntity.tab.remove"))}function uf(){var e;return!!(Ir(Xn)&&gf()&&(null===(e=Xn.supports.hostEntity)||void 0===e?void 0:e.tab))}function df(e){if(!e||0==e.length)throw new Error(`Error code: ${Re.INVALID_ARGUMENTS}, message: ThreadId cannot be null or empty`)}function ff(e){if(!(null==e?void 0:e.internalTabInstanceId)||0===e.internalTabInstanceId.length)throw new Error(`Error code: ${Re.INVALID_ARGUMENTS}, message: TabId cannot be null or empty`)}var pf;function gf(){return!(!Ir(Xn)||!Xn.supports.hostEntity)}!function(e){e.edu="EDU",e.baseTownhall="BASE_TOWNHALL",e.streamingTownhall="STREAMING_TOWNHALL"}(pf||(pf={}));var mf=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const hf="v2",vf="Invalid store dialog size",wf="No App Id present, but AppId needed to open AppDetail store",Cf="No Collection Id present, but CollectionId needed to open a store specific to a collection";function yf(e){return mf(this,void 0,void 0,(function*(){If();const{size:t}=null!=e?e:{};return qs("store.openFullStore",[Tf(t)],zn(hf,"store.openFullStore"))}))}function bf(e){return mf(this,void 0,void 0,(function*(){If();const{size:t,appId:n}=e;if(!(n instanceof Ur))throw new Error(wf);return qs("store.openAppDetail",[Tf(t),n],zn(hf,"store.openAppDetail"))}))}function Sf(e){return mf(this,void 0,void 0,(function*(){If();const{size:t,appCapability:n,appMetaCapabilities:r,installationScope:o,filteredOutAppIds:i}=null!=e?e:{};return qs("store.openInContextStore",[Tf(t),n,r,o,null==i?void 0:i.map((e=>e.toString()))],zn(hf,"store.openInContextStore"))}))}function Ef(e){return mf(this,void 0,void 0,(function*(){If();const{size:t,collectionId:n}=e;if(void 0===n)throw new Error(Cf);return qs("store.openSpecificStore",[Tf(t),n],zn(hf,"store.openSpecificStore"))}))}function Af(){return Ir(Xn)&&!!Xn.supports.store}function If(){if(Ir(Xn,rn.content,rn.sidePanel,rn.meetingStage),!Af())throw ln}function Tf(e){if(void 0===e)return;const{width:t,height:n}=e;if(void 0!==t&&"number"==typeof t&&t<0)throw new Error(vf);if(void 0!==n&&"number"==typeof n&&n<0)throw new Error(vf);return JSON.stringify(e)}var Pf=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Of="v1",Rf="v2";let Ff;function kf(e){Ff=e}function Mf(e){const t=void 0!==e,n=t?e:Ff;if(!n)throw new Error("No parameters are provided for authentication");Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.remove,rn.task,rn.stage,rn.meetingStage);return Nf(n.successCallback||n.failureCallback?zn(Of,"authentication.authenticate"):zn(Rf,"authentication.authenticate"),n).then((e=>{try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(Ff=void 0)}})).catch((e=>{try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(Ff=void 0)}}))}function Nf(e,t){return Pf(this,void 0,void 0,(function*(){const n=kn(t.url);return Fn(n),js(e,"authentication.authenticate",[n.href,t.width,t.height,t.isExternal]).then((([e,t])=>{if(e)return t;throw new Error(t)}))}))}function xf(e){Ar();return Lf(e&&(e.successCallback||e.failureCallback)?zn(Of,"authentication.getAuthToken"):zn(Rf,"authentication.getAuthToken"),e).then((t=>e&&e.successCallback?(e.successCallback(t),""):t)).catch((t=>{if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t}))}function Lf(e,t){return new Promise((n=>{n(js(e,"authentication.getAuthToken",[null==t?void 0:t.resources,null==t?void 0:t.claims,null==t?void 0:t.silent,null==t?void 0:t.tenantId]))})).then((([e,t])=>{if(e)return t;throw new Error(t)}))}function Uf(e){Ar();return Df(e&&(e.successCallback||e.failureCallback)?zn(Of,"authentication.getUser"):zn(Rf,"authentication.getUser")).then((t=>e&&e.successCallback?(e.successCallback(t),null):t)).catch((t=>{const n=`Error returned, code = ${t.errorCode}, message = ${t.message}`;if(e&&e.failureCallback)return e.failureCallback(n),null;throw new Error(n)}))}function Df(e){return new Promise((t=>{t(js(e,"authentication.getUser"))})).then((([e,t])=>{if(e)return t;throw t}))}function Hf(e,t){Ir(Xn,rn.authentication);Qs(zn(t?Of:Rf,"authentication.notifySuccess"),"authentication.authenticate.success",[e]),yc(Ls.parentWindow,(()=>setTimeout((()=>Ls.currentWindow.close()),200)))}function Vf(e,t){Ir(Xn,rn.authentication);Qs(zn(t?Of:Rf,"authentication.notifyFailure"),"authentication.authenticate.failure",[e]),yc(Ls.parentWindow,(()=>setTimeout((()=>Ls.currentWindow.close()),200)))}var _f;function Bf(e){const t=!e||e.length<=0,n=null==e?void 0:e.indexOf("@"),r=null==e?void 0:e.indexOf(".",n);if(t||-1===n||-1===r)throw new Error("Input email address does not have the correct format.")}!function(e){e.Public="public",e.EUDB="eudb",e.Other="other"}(_f||(_f={}));class Wf{constructor(e){this.val=e,Bf(e)}toString(){return this.val}}const jf="/l/app/",zf="/l/meeting/new",$f="attendees",qf="startTime",Gf="endTime",Jf="subject",Kf="content",Qf="/l/call/0/0",Zf="source",Xf="withVideo",Yf="/l/chat/0/0",ep="users",tp="topicName",np="message";function rp(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");const r=`${ep}=`+e.map((e=>encodeURIComponent(e))).join(","),o=void 0===t?"":`&${tp}=${encodeURIComponent(t)}`,i=void 0===n?"":`&${np}=${encodeURIComponent(n)}`;return`${Ye}://${et}${Yf}?${r}${o}${i}`}function op(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");const r=`${ep}=`+e.map((e=>encodeURIComponent(e))).join(","),o=void 0===t?"":`&${Xf}=${encodeURIComponent(t)}`,i=void 0===n?"":`&${Zf}=${encodeURIComponent(n)}`;return`${Ye}://${et}${Qf}?${r}${o}${i}`}function ip(e,t,n,r,o){const i=void 0===e?"":`${$f}=`+e.map((e=>encodeURIComponent(e))).join(","),a=void 0===t?"":`&${qf}=${encodeURIComponent(t)}`,s=void 0===n?"":`&${Gf}=${encodeURIComponent(n)}`,c=void 0===r?"":`&${Jf}=${encodeURIComponent(r)}`,l=void 0===o?"":`&${Kf}=${encodeURIComponent(o)}`;return`${Ye}://${et}${zf}?${i}${a}${s}${c}${l}`}function ap(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return`${Ye}://${et}${jf}${encodeURIComponent(e)}`}const sp="v1";function cp(e){return new Promise((t=>{if(Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.task,rn.stage,rn.meetingStage),!lp())throw new Error("Not supported");const n=zn(sp,"appInstallDialog.openAppInstallDialog");Xn.isLegacyTeams?t(_s(n,"executeDeepLink",ap(e.appId))):(Qs(n,"appInstallDialog.openAppInstallDialog",[e]),t())}))}function lp(){return!(!Ir(Xn)||!Xn.supports.appInstallDialog)}const up="v1",dp=jn("media");var fp,pp,gp,mp,hp,vp,wp;!function(e){e.Base64="base64",e.ID="id"}(fp||(fp={}));class Cp{}function yp(e){if(!e)throw new Error("[captureImage] Callback cannot be null");if(Ir(Xn,rn.content,rn.task),it.isFramelessWindow)if(Tr(qe))Qs(zn(up,"media.captureImage"),"captureImage",e);else{e({errorCode:Re.OLD_PLATFORM},[])}else{e({errorCode:Re.NOT_SUPPORTED_ON_PLATFORM},[])}}function bp(){if(Ir(Xn,rn.content,rn.task),!Ep())throw ln;const e=Fe.Media;return new Promise((t=>{t(Ws(zn(up,"media.hasPermission"),"permissions.has",e))}))}function Sp(){if(Ir(Xn,rn.content,rn.task),!Ep())throw ln;const e=Fe.Media;return new Promise((t=>{t(Ws(zn(up,"media.requestPermission"),"permissions.request",e))}))}function Ep(){return!(!Ir(Xn)||!Xn.supports.permissions)}class Ap extends Cp{constructor(e){super(),e&&(this.content=e.content,this.format=e.format,this.mimeType=e.mimeType,this.name=e.name,this.preview=e.preview,this.size=e.size)}getMedia(e){if(!e)throw new Error("[get Media] Callback cannot be null");if(Ir(Xn,rn.content,rn.task),Tr(Ge))if(Hp(this.mimeType,this.format,this.content))Tr("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e);else{e({errorCode:Re.INVALID_ARGUMENTS},new Blob)}else{e({errorCode:Re.OLD_PLATFORM},new Blob)}}getMediaViaCallback(e){const t={mediaMimeType:this.mimeType,assembleAttachment:[]},n=[this.content];Qs(zn(up,"media.getMedia"),"getMedia",n,(function(n){if(e)if(n&&n.error)e(n.error,new Blob);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){const r=Fp(t.assembleAttachment,t.mediaMimeType);e(n.error,null!=r?r:new Blob)}else{const e=kp(n.mediaChunk,t.mediaMimeType);e?t.assembleAttachment.push(e):dp(`Received a null assemble attachment for when decoding chunk sequence ${n.mediaChunk.chunkSequence}; not including the chunk in the assembled file.`)}else e({errorCode:Re.INTERNAL_ERROR,message:"data received is null"},new Blob)}))}getMediaViaHandler(e){const t=hn(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},r=[t,this.content];this.content&&!Dr(e)&&Qs(zn(up,"media.getMedia"),"getMedia",r),Xa(zn(up,"media.registerGetMediaRequestHandler"),"getMedia"+t,(function(r){if(e){const o=JSON.parse(r);if(o.error)e(o.error,new Blob),Ya("getMedia"+t);else if(o.mediaChunk)if(o.mediaChunk.chunkSequence<=0){const r=Fp(n.assembleAttachment,n.mediaMimeType);e(o.error,null!=r?r:new Blob),Ya("getMedia"+t)}else{const e=kp(o.mediaChunk,n.mediaMimeType);e&&n.assembleAttachment.push(e)}else e({errorCode:Re.INTERNAL_ERROR,message:"data received is null"},new Blob),Ya("getMedia"+t)}}))}}class Ip{constructor(e){this.controllerCallback=e}notifyEventToHost(e,t){Ir(Xn,rn.content,rn.task);try{Or(Be)}catch(e){return void(t&&t(e))}const n={mediaType:this.getMediaType(),mediaControllerEvent:e};Qs(zn(up,"media.controller"),"media.controller",[n],(e=>{t&&t(e)}))}stop(e){this.notifyEventToHost(pp.StopRecording,e)}}class Tp extends Ip{getMediaType(){return hp.Video}notifyEventToApp(e){if(this.controllerCallback)switch(e){case pp.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}}}function Pp(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(Ir(Xn,rn.content,rn.task),!Tr(Ge)){const e={errorCode:Re.OLD_PLATFORM};return void t(e,[])}try{Mp(e)}catch(e){return void t(e,[])}if(!xp(e)){const e={errorCode:Re.INVALID_ARGUMENTS};return void t(e,[])}const n=[e];Qs(zn(up,"media.selectMedia"),"selectMedia",n,((n,r,o)=>{var i,a;if(o)return void(Np(e)&&(null===(a=null===(i=null==e?void 0:e.videoProps)||void 0===i?void 0:i.videoController)||void 0===a||a.notifyEventToApp(o)));if(!r)return void t(n,[]);const s=[];for(const e of r)s.push(new Ap(e));t(n,s)}))}function Op(e,t){if(!t)throw new Error("[view images] Callback cannot be null");if(Ir(Xn,rn.content,rn.task),!Tr(Ge)){return void t({errorCode:Re.OLD_PLATFORM})}if(!Vp(e)){return void t({errorCode:Re.INVALID_ARGUMENTS})}const n=[e];Qs(zn(up,"media.viewImages"),"viewImages",n,t)}function Rp(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");if(Ir(Xn,rn.content,rn.task),it.hostClientType!==tn.desktop&&it.hostClientType!==tn.web&&it.hostClientType!==tn.rigel&&it.hostClientType!==tn.teamsRoomsWindows&&it.hostClientType!==tn.teamsRoomsAndroid&&it.hostClientType!==tn.teamsPhones&&it.hostClientType!==tn.teamsDisplays)if(Tr(Je))if(_p(t))Qs(zn(up,"media.scanBarCode"),"media.scanBarCode",[t],e);else{e({errorCode:Re.INVALID_ARGUMENTS},"")}else{e({errorCode:Re.OLD_PLATFORM},"")}else{e({errorCode:Re.NOT_SUPPORTED_ON_PLATFORM},"")}}function Fp(e,t){if(null==e||null==t||e.length<=0)return null;let n=null,r=1;return e.sort(((e,t)=>e.sequence>t.sequence?1:-1)),e.forEach((e=>{e.sequence==r&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),r++)})),n}function kp(e,t){if(null==e||null==t)return null;const n=atob(e.chunk),r=new Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);const o=new Uint8Array(r),i=new Blob([o],{type:t});return{sequence:e.chunkSequence,file:i}}function Mp(e){Up(e)?Or(_e):Dp(e)?Or(Be):Lp(e)&&Or(We)}function Np(e){return!(e.mediaType!=hp.Video||!e.videoProps||!e.videoProps.videoController)}function xp(e){return!(null==e||e.maxMediaCount>10)}function Lp(e){var t;return!((null==e?void 0:e.mediaType)!=hp.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}function Up(e){return!(!e||e.mediaType!=hp.VideoAndImage&&!e.videoAndImageProps)}function Dp(e){return!(!e||e.mediaType!=hp.Video||!e.videoProps||e.videoProps.isFullScreenMode)}function Hp(e,t,n){return null!=e&&null!=t&&t==fp.ID&&null!=n}function Vp(e){return!(null==e||e.length<=0||e.length>10)}function _p(e){return!e||!(null===e.timeOutIntervalInSec||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec<=0||null!=e.timeOutIntervalInSec&&e.timeOutIntervalInSec>60)}function Bp(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}!function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(pp||(pp={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(gp||(gp={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(mp||(mp={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(hp||(hp={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(vp||(vp={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(wp||(wp={}));const Wp="v2";function jp(e){return new Promise((t=>{if(Ir(Xn,rn.content,rn.task),!qp())throw ln;if(!_p(e))throw{errorCode:Re.INVALID_ARGUMENTS};t(Ws(zn(Wp,"barCode.scanBarCode"),"media.scanBarCode",e))}))}function zp(){if(Ir(Xn,rn.content,rn.task),!qp())throw ln;const e=Fe.Media;return new Promise((t=>{t(Ws(zn(Wp,"barCode.hasPermission"),"permissions.has",e))}))}function $p(){if(Ir(Xn,rn.content,rn.task),!qp())throw ln;const e=Fe.Media;return new Promise((t=>{t(Ws(zn(Wp,"barCode.requestPermission"),"permissions.request",e))}))}function qp(){return!!(Ir(Xn)&&Xn.supports.barCode&&Xn.supports.permissions)}const Gp="v2";function Jp(e){return Kp(zn(Gp,"chat.openChat"),e)}function Kp(e,t){return new Promise((n=>{if(Ir(Xn,rn.content,rn.task),!Zp())throw ln;if(Xn.isLegacyTeams)n(_s(e,"executeDeepLink",rp([t.user],void 0,t.message)));else{n(_s(e,"chat.openChat",{members:[t.user],message:t.message}))}}))}function Qp(e){const t=zn(Gp,"chat.openGroupChat");return new Promise((n=>{if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length){const r={user:e.users[0],message:e.message};n(Kp(t,r))}else{if(Ir(Xn,rn.content,rn.task),!Zp())throw ln;if(Xn.isLegacyTeams)n(_s(t,"executeDeepLink",rp(e.users,e.topic,e.message)));else{n(_s(t,"chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}}}))}function Zp(){return!(!Ir(Xn)||!Xn.supports.chat)}var Xp=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Yp="v2";function eg(e){return Xp(this,void 0,void 0,(function*(){if(Ir(Xn,rn.content,rn.meetingStage,rn.task,rn.settings,rn.stage,rn.sidePanel),!ng())throw ln;if(!e.type||!Object.values(Le).includes(e.type))throw new Error(`Blob type ${e.type} is not supported. Supported blob types are ${Object.values(Le)}`);const t=yield Tn(e),n={mimeType:e.type,content:t};return Ws(zn(Yp,"clipboard.write"),"clipboard.writeToClipboard",n)}))}function tg(){return Xp(this,void 0,void 0,(function*(){Ir(Xn,rn.content,rn.meetingStage,rn.task,rn.settings,rn.stage,rn.sidePanel);const e=zn(Yp,"clipboard.read");if(!ng())throw ln;const t=yield Ws(e,"clipboard.readFromClipboard");if("string"==typeof t){const e=JSON.parse(t);return In(e.mimeType,e.content)}return t}))}function ng(){return it.isFramelessWindow?!(!Ir(Xn)||!Xn.supports.clipboard):!!(Ir(Xn)&&navigator&&navigator.clipboard&&Xn.supports.clipboard)}function rg(){var e;return null!==(e=Ir(Xn)&&(Xn.isNAAChannelRecommended||og()))&&void 0!==e&&e}function og(){return!!(Ir(Xn)&&ig()&&Xn.isLegacyTeams&&Xn.supports.nestedAppAuth)}function ig(){return it.hostClientType===tn.android||it.hostClientType===tn.ios||it.hostClientType===tn.ipados||it.hostClientType===tn.visionOS}const ag="v2";function sg(){if(Ir(Xn,rn.content,rn.task),!lg())throw ln;return Ws(zn(ag,"geoLocation.map.chooseLocation"),"location.getLocation",{allowChooseLocation:!0,showMap:!0})}function cg(e){if(Ir(Xn,rn.content,rn.task),!lg())throw ln;if(!e)throw{errorCode:Re.INVALID_ARGUMENTS};return Ws(zn(ag,"geoLocation.showLocation"),"location.showLocation",e)}function lg(){return!!(Ir(Xn)&&Xn.supports.geoLocation&&Xn.supports.geoLocation.map&&Xn.supports.permissions)}const ug="v2";function dg(){if(Ir(Xn,rn.content,rn.task),!gg())throw ln;return Ws(zn(ug,"geoLocation.getCurrentLocation"),"location.getLocation",{allowChooseLocation:!1,showMap:!1})}function fg(){if(Ir(Xn,rn.content,rn.task),!gg())throw ln;const e=Fe.GeoLocation;return new Promise((t=>{t(Ws(zn(ug,"geoLocation.hasPermission"),"permissions.has",e))}))}function pg(){if(Ir(Xn,rn.content,rn.task),!gg())throw ln;const e=Fe.GeoLocation;return new Promise((t=>{t(Ws(zn(ug,"geoLocation.requestPermission"),"permissions.request",e))}))}function gg(){return!!(Ir(Xn)&&Xn.supports.geoLocation&&Xn.supports.permissions)}function mg(){return Xn.hostVersionsInfo?Xn.hostVersionsInfo.adaptiveCardSchemaVersion:void 0}const hg="v1";class vg{postMessage(e,t){Ir(Xn),Qs(zn(hg,"appWindow.childAppWindow.postMessage"),"messageForChild",[e],t||gn())}addEventListener(e,t){Ir(Xn),"message"===e&&Xa(zn(hg,"appWindow.childAppWindow.addEventListener"),"messageForParent",t)}}class wg{static get Instance(){return this._instance||(this._instance=new this)}postMessage(e,t){Ir(Xn,rn.task),Qs(zn(hg,"appWindow.parentAppWindow.postMessage"),"messageForParent",[e],t||gn())}addEventListener(e,t){Ir(Xn,rn.task),"message"===e&&Xa(zn(hg,"appWindow.parentAppWindow.addEventListener"),"messageForChild",t)}}const Cg="v2";function yg(e){if(Ir(Xn,rn.content),!bg())throw ln;if(!e||!An(e))throw{errorCode:Re.INVALID_ARGUMENTS,message:"Invalid Url: Only https URL is allowed"};return Ws(zn(Cg,"secondaryBrowser.openUrl"),"secondaryBrowser.open",e.toString())}function bg(){return!(!Ir(Xn)||!Xn.supports.secondaryBrowser)}const Sg="v1";function Eg(e,t){if(!t)throw new Error("[location.getLocation] Callback cannot be null");if(Ir(Xn,rn.content,rn.task),!Tr(ze))throw{errorCode:Re.OLD_PLATFORM};if(!e)throw{errorCode:Re.INVALID_ARGUMENTS};if(!Ig())throw ln;Qs(zn(Sg,"location.getLocation"),"location.getLocation",[e],t)}function Ag(e,t){if(!t)throw new Error("[location.showLocation] Callback cannot be null");if(Ir(Xn,rn.content,rn.task),!Tr(ze))throw{errorCode:Re.OLD_PLATFORM};if(!e)throw{errorCode:Re.INVALID_ARGUMENTS};if(!Ig())throw ln;Qs(zn(Sg,"location.showLocation"),"location.showLocation",[e],t)}function Ig(){return!(!Ir(Xn)||!Xn.supports.location)}const Tg="v1";function Pg(e){Ir(Xn,rn.sidePanel),e.contentUrl&&new URL(e.contentUrl),Qs(zn(Tg,"meeting.appShareButton.setOptions"),"meeting.appShareButton.setOptions",[e])}var Og=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Rg="v1";var Fg,kg,Mg,Ng,xg,Lg;function Ug(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Qs(zn(Rg,"meeting.getIncomingClientAudioState"),"getIncomingClientAudioState",e)}function Dg(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Qs(zn(Rg,"meeting.toggleIncomingClientAudio"),"toggleIncomingClientAudio",e)}function Hg(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage,rn.settings,rn.content),Qs(zn(Rg,"meeting.getMeetingDetails"),"meeting.getMeetingDetails",e)}function Vg(){var e,t,n;return Og(this,void 0,void 0,(function*(){let r;Ir(Xn,rn.sidePanel,rn.meetingStage,rn.settings,rn.content);try{const e=!0;r=yield Ws(zn("v2","meeting.getMeetingDetailsVerbose"),"meeting.getMeetingDetails",e)}catch(t){throw new Error(null===(e=null==t?void 0:t.errorCode)||void 0===e?void 0:e.toString())}if(((null===(t=r.details)||void 0===t?void 0:t.type)==Ng.GroupCall||(null===(n=r.details)||void 0===n?void 0:n.type)==Ng.OneOnOneCall)&&!r.details.originalCallerInfo)throw new Error(Re.NOT_SUPPORTED_ON_PLATFORM.toString());return r}))}function _g(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage,rn.task),Qs(zn(Rg,"meeting.getAuthenticationTokenForAnonymousUser"),"meeting.getAuthenticationTokenForAnonymousUser",e)}function Bg(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");Ir(Xn,rn.sidePanel),Qs(zn(Rg,"meeting.getLiveStreamState"),"meeting.getLiveStreamState",e)}function Wg(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");Ir(Xn,rn.sidePanel),Qs(zn(Rg,"meeting.requestStartLiveStreaming"),"meeting.requestStartLiveStreaming",[t,n],e)}function jg(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");Ir(Xn,rn.sidePanel),Qs(zn(Rg,"meeting.requestStopLiveStreaming"),"meeting.requestStopLiveStreaming",e)}function zg(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");Ir(Xn,rn.sidePanel),Xa(zn(Rg,"meeting.registerLiveStreamChangedHandler"),"meeting.liveStreamChanged",e)}function $g(e,t,n={sharingProtocol:xg.Collaborative}){if(!e)throw new Error("[share app content to stage] Callback cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Qs(zn(Rg,"meeting.shareAppContentToStage"),"meeting.shareAppContentToStage",[t,n],e)}function qg(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Qs(zn(Rg,"meeting.getAppContentStageSharingCapabilities"),"meeting.getAppContentStageSharingCapabilities",e)}function Gg(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Qs(zn(Rg,"meeting.stopSharingAppContentToStage"),"meeting.stopSharingAppContentToStage",e)}function Jg(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Qs(zn(Rg,"meeting.getAppContentStageSharingState"),"meeting.getAppContentStageSharingState",e)}function Kg(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Xa(zn(Rg,"meeting.registerSpeakingStateChangeHandler"),"meeting.speakingStateChanged",e)}function Qg(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Xa(zn(Rg,"meeting.registerRaiseHandStateChangedHandler"),"meeting.raiseHandStateChanged",e)}function Zg(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),Xa(zn(Rg,"meeting.registerMeetingReactionReceivedHandler"),"meeting.meetingReactionReceived",e)}function Xg(e){if(void 0===(null==e?void 0:e.joinWebUrl)||null===(null==e?void 0:e.joinWebUrl))return Promise.reject(new Error("Invalid joinMeetingParams"));Ir(Xn);const t={joinWebUrl:e.joinWebUrl.href,source:e.source||Lg.Other};return Ws(zn("v2","meeting.joinMeeting"),"meeting.joinMeeting",t)}function Yg(e,t){if(!t)throw new Error("[requestAppAudioHandling] Callback response cannot be null");if(!e.micMuteStateChangedCallback)throw new Error("[requestAppAudioHandling] Callback Mic mute state handler cannot be null");Ir(Xn,rn.sidePanel,rn.meetingStage),e.isAppHandlingAudio?em(e,t):tm(e,t)}function em(e,t){Qs(zn(Rg,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((n,r)=>{if(n&&null!=r)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(n)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${n.errorCode} ${n.message}`);if("boolean"!=typeof r)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");Xa(zn(Rg,"meeting.registerMicStateChangeHandler"),"meeting.micStateChanged",(t=>Og(this,void 0,void 0,(function*(){try{const n=yield e.micMuteStateChangedCallback(t);rm(n,n.isMicMuted===t.isMicMuted?Fg.HostInitiated:Fg.AppDeclinedToChange)}catch(e){rm(t,Fg.AppFailedToChange)}}))));Xa(zn(Rg,"meeting.registerAudioDeviceSelectionChangedHandler"),"meeting.audioDeviceSelectionChanged",(t=>{var n;null===(n=e.audioDeviceSelectionChangedCallback)||void 0===n||n.call(e,t)})),t(r)}))}function tm(e,t){Qs(zn(Rg,"meeting.requestAppAudioHandling"),"meeting.requestAppAudioHandling",[e.isAppHandlingAudio],((e,n)=>{if(e&&null!=n)throw new Error("[requestAppAudioHandling] Callback response - both parameters cannot be set");if(e)throw new Error(`[requestAppAudioHandling] Callback response - SDK error ${e.errorCode} ${e.message}`);if("boolean"!=typeof n)throw new Error("[requestAppAudioHandling] Callback response - isHostAudioless must be a boolean");es("meeting.micStateChanged")&&Ya("meeting.micStateChanged"),es("meeting.audioDeviceSelectionChanged")&&Ya("meeting.audioDeviceSelectionChanged"),t(n)}))}function nm(e){rm(e,Fg.AppInitiated)}function rm(e,t){Ir(Xn,rn.sidePanel,rn.meetingStage),Qs(zn(Rg,"meeting.setMicStateWithReason"),"meeting.updateMicState",[e,t])}!function(e){e[e.HostInitiated=0]="HostInitiated",e[e.AppInitiated=1]="AppInitiated",e[e.AppDeclinedToChange=2]="AppDeclinedToChange",e[e.AppFailedToChange=3]="AppFailedToChange"}(Fg||(Fg={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(kg||(kg={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(Mg||(Mg={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(Ng||(Ng={})),function(e){e.Collaborative="Collaborative",e.ScreenShare="ScreenShare"}(xg||(xg={})),function(e){e.M365CalendarGridContextMenu="m365_calendar_grid_context_menu",e.M365CalendarGridPeek="m365_calendar_grid_peek",e.M365CalendarGridEventCardJoinButton="m365_calendar_grid_event_card_join_button",e.M365CalendarFormRibbonJoinButton="m365_calendar_form_ribbon_join_button",e.M365CalendarFormJoinTeamsMeetingButton="m365_calendar_form_join_teams_meeting_button",e.Other="other"}(Lg||(Lg={}));const om="v1",im="v2";function am(e,t){let n,r,o="";"function"==typeof e?(n=e,r=t,o=zn(om,"monetization.openPurchaseExperience")):(r=e,o=zn(im,"monetization.openPurchaseExperience"));return Ir(Xn,rn.content),yn((()=>new Promise((e=>{if(!sm())throw ln;e(Ws(o,"monetization.openPurchaseExperience",r))}))),n)}function sm(){return!(!Ir(Xn)||!Xn.supports.monetization)}const cm="v2";function lm(e){return new Promise((t=>{if(Ir(Xn,rn.content),!dm())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");t(_s(zn(cm,"calendar.openCalendarItem"),"calendar.openCalendarItem",e))}))}function um(e){return new Promise((t=>{if(Ir(Xn,rn.content),!dm())throw new Error("Not supported");const n=zn(cm,"calendar.composeMeeting");Xn.isLegacyTeams?t(_s(n,"executeDeepLink",ip(e.attendees,e.startTime,e.endTime,e.subject,e.content))):t(_s(n,"calendar.composeMeeting",e))}))}function dm(){return!(!Ir(Xn)||!Xn.supports.calendar)}const fm="v2";function pm(e){e&&0!==e.length&&e.forEach((e=>{Bf(e)}))}function gm(e){if(!e.handoffId||0==e.handoffId.trim().length||""===e.handoffId.trim())throw new Error("handoffId should not be null or empty string.");const t=e.composeMailParams;t.type===Sm.New&&(pm(t.toRecipients),pm(t.ccRecipients),pm(t.bccRecipients))}function mm(e){if(Ir(Xn,rn.content),!hm())throw new Error("Not supported");return gm(e),qs("mail.handoff.composeMail",[new vm(e)],zn(fm,"mail.handoff.composeMail"))}function hm(){return!!(Ir(Xn)&&Xn.supports.mail&&Xn.supports.mail.handoff)}class vm{constructor(e){this.composeMailParamsWithHandoff=e}serialize(){return this.composeMailParamsWithHandoff}}const wm="v2";function Cm(e){return new Promise((t=>{if(Ir(Xn,rn.content),!bm())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");t(_s(zn(wm,"mail.openMailItem"),"mail.openMailItem",e))}))}function ym(e){return new Promise((t=>{if(Ir(Xn,rn.content),!bm())throw new Error("Not supported");t(_s(zn(wm,"mail.composeMail"),"mail.composeMail",e))}))}function bm(){return!(!Ir(Xn)||!Xn.supports.mail)}var Sm;!function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(Sm||(Sm={}));const Em="v2";function Am(){if(!it.printCapabilityEnabled){if(Ir(Xn),!Fm())throw ln;it.printCapabilityEnabled=!0,document.addEventListener("keydown",(e=>{(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(Im(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))}}function Im(){Pn().print()}function Tm(e){Pm(zn(Em,"teamsAPIs_registerOnLoadHandler"),e,(()=>{if(!Dr(e)&&!Fm())throw ln}))}function Pm(e,t,n){!Dr(t)&&Ir(Xn),!Dr(t)&&n&&n(),as(e,t)}function Om(e){Rm(zn(Em,"teamsAPIs_registerBeforeUnloadHandler"),e,(()=>{if(!Dr(e)&&!Fm())throw ln}))}function Rm(e,t,n){!Dr(t)&&Ir(Xn),!Dr(t)&&n&&n(),ls(e,t)}function Fm(){return!(!Ir(Xn)||!Xn.supports.teamsCore)}const km="v1",Mm="v2";function Nm(e,t){let n,r;Ir(Xn,rn.content,rn.task,rn.settings);let o="";return"function"==typeof e?([n,r]=[e,t],o=zn(km,"people.selectPeople")):(r=e,o=zn(Mm,"people.selectPeople")),wn(xm,n,o,r)}function xm(e,t){return new Promise((n=>{if(!Tr($e))throw{errorCode:Re.OLD_PLATFORM};if(!Bp(t))throw{errorCode:Re.INVALID_ARGUMENTS};if(!Lm())throw ln;n(Ws(e,"people.selectPeople",t))}))}function Lm(){return!(!Ir(Xn)||!Xn.supports.people)}function Um(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?Dm(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}function Dm(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}const Hm="v2";function Vm(e){return Ir(Xn,rn.content),new Promise((t=>{const[n,r]=Um(e);if(!n)throw{errorCode:Re.INVALID_ARGUMENTS,message:r};const o={modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}};t(Ws(zn(Hm,"profile.showProfile"),"profile.showProfile",o))}))}function _m(){return!(!Ir(Xn)||!Xn.supports.profile)}const Bm="v2",Wm="search.queryChange",jm="search.queryClose",zm="search.queryExecute";function $m(e,t,n){if(Ir(Xn,rn.content),!Gm())throw ln;Xa(zn(Bm,"search.registerOnClosedHandler"),jm,e),Xa(zn(Bm,"search.registerOnExecutedHandler"),zm,t),n&&Xa(zn(Bm,"search.registerOnChangeHandler"),Wm,n)}function qm(){if(Ir(Xn,rn.content),!Gm())throw ln;Qs(zn(Bm,"search.unregisterHandlers"),"search.unregister"),Ya(Wm),Ya(jm),Ya(zm)}function Gm(){return!(!Ir(Xn)||!Xn.supports.search)}function Jm(){return new Promise((e=>{if(Ir(Xn,rn.content),!Gm())throw new Error("Not supported");e(_s(zn(Bm,"search.closeSearch"),"search.closeSearch"))}))}var Km=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const Qm="v2";function Zm(){return Km(this,void 0,void 0,(function*(){if(Ir(Xn,rn.sidePanel,rn.meetingStage),!Xm())throw ln;return yield Ws(zn(Qm,"sharing.history.getContent"),"sharing.history.getContent")}))}function Xm(){var e;return Ir(Xn)&&void 0!==(null===(e=Xn.supports.sharing)||void 0===e?void 0:e.history)}const Ym="v1",eh="v2",th={shareWebContent:"sharing.shareWebContent"};function nh(e,t){try{oh(e),ih(e),ah(e)}catch(e){return Cn((()=>Promise.reject(e)),t)}Ir(Xn,rn.content,rn.sidePanel,rn.task,rn.stage,rn.meetingStage);return Cn(rh,t,zn(t?Ym:eh,"sharing.shareWebContent"),e)}function rh(e,t){return new Promise((n=>{if(!sh())throw ln;n(Ws(e,th.shareWebContent,t))}))}function oh(e){if(!(e&&e.content&&e.content.length)){throw{errorCode:Re.INVALID_ARGUMENTS,message:"Shared content is missing"}}}function ih(e){let t;if(e.content.some((e=>!e.type)))throw t={errorCode:Re.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"},t;if(e.content.some((t=>t.type!==e.content[0].type)))throw t={errorCode:Re.INVALID_ARGUMENTS,message:"Shared content must be of the same type"},t}function ah(e){let t;if("URL"!==e.content[0].type)throw t={errorCode:Re.INVALID_ARGUMENTS,message:"Content type is unsupported"},t;if(e.content.some((e=>!e.url)))throw t={errorCode:Re.INVALID_ARGUMENTS,message:"URLs are required for URL content types"},t}function sh(){return!(!Ir(Xn)||!Xn.supports.sharing)}const ch="v2";function lh(){return new Promise((e=>{if(Ir(Xn,rn.content),!uh())throw ln;e(Ws(zn(ch,"stageView.self.close"),"stageView.self.close"))}))}function uh(){var e;return Ir(Xn)&&void 0!==(null===(e=Xn.supports.stageView)||void 0===e?void 0:e.self)}const dh="v2";var fh;function ph(e){return new Promise((t=>{if(Ir(Xn,rn.content),!gh())throw ln;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");t(Ws(zn(dh,"stageView.open"),"stageView.open",e))}))}function gh(){return!(!Ir(Xn)||!Xn.supports.stageView)}!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(fh||(fh={}));const mh=10;var hh=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};const vh="v2";function wh(e){return hh(this,void 0,void 0,(function*(){Ir(Xn,rn.content,rn.task),bh(),Sh(e);const t=yield Ws(zn(vh,"visualMedia.image.captureImages"),"visualMedia.image.captureImages",e);return Eh(e.maxVisualMediaCount,t),t}))}function Ch(e){return hh(this,void 0,void 0,(function*(){Ir(Xn,rn.content,rn.task),bh(),Sh(e);const t=yield Ws(zn(vh,"visualMedia.image.retrieveImages"),"visualMedia.image.retrieveImages",e);return Eh(e.maxVisualMediaCount,t),t}))}function yh(){return!!(Ir(Xn)&&Xn.supports.visualMedia&&Xn.supports.visualMedia.image&&Xn.supports.permissions)}function bh(){if(!yh())throw ln}function Sh(e){if(!e||e.maxVisualMediaCount>mh||e.maxVisualMediaCount<1)throw fn}function Eh(e,t){if(t.length>e)throw pn}const Ah="v2";var Ih,Th;function Ph(){if(Ir(Xn,rn.content,rn.task),!yh())throw ln;const e=Fe.Media;return Ws(zn(Ah,"visualMedia.hasPermission"),"permissions.has",e)}function Oh(){if(Ir(Xn,rn.content,rn.task),!yh())throw ln;const e=Fe.Media;return Ws(zn(Ah,"visualMedia.requestPermission"),"permissions.request",e)}!function(e){e[e.FrontOrRear=1]="FrontOrRear",e[e.FrontOnly=2]="FrontOnly",e[e.RearOnly=3]="RearOnly"}(Ih||(Ih={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(Th||(Th={}));var Rh=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};let Fh=null;function kh(){return Rh(this,void 0,void 0,(function*(){return null===Fh&&(Fh=(yield uo()).app.host.name),Fh}))}var Mh=function(e,t,n,r){function o(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?n(e.value):o(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())}))};function Nh(){return Mh(this,void 0,void 0,(function*(){if(Ir(Xn),!Lh())throw ln;return!(!Xn.isLegacyTeams||it.hostClientType!==tn.android&&it.hostClientType!==tn.ios&&it.hostClientType!==tn.ipados&&it.hostClientType!==tn.visionOS||(yield xh())!==nn.teams)||(yield Vs(zn("v2","webStorage.isWebStorageClearedOnUserLogOut"),"webStorage.isWebStorageClearedOnUserLogOut"))}))}function xh(){return Mh(this,void 0,void 0,(function*(){return kh()}))}function Lh(){return Ir(Xn)&&void 0!==Xn.supports.webStorage}const Uh="v2";var Dh;function Hh(e){const t=zn(Uh,"call.startCall");return new Promise((n=>{var r;if(Ir(Xn,rn.content,rn.task),!Vh())throw ln;if(!Xn.isLegacyTeams)return Qs(t,"call.startCall",[e],n);n(Vs(t,"executeDeepLink",op(e.targets,null===(r=e.requestedModalities)||void 0===r?void 0:r.includes(Dh.Video),e.source)).then((e=>{if(!e)throw new Error(ot);return e})))}))}function Vh(){return!(!Ir(Xn)||!Xn.supports.call)}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(Dh||(Dh={}));const _h="v1";function Bh(){Fi(zn(_h,"appInitialization.notifyAppLoaded"))}function Wh(){Qs(zn(_h,"appInitialization.notifySuccess"),no.Success,[fr])}function jh(e){Mi(zn(_h,"appInitialization.notifyFailure"),e)}function zh(e){ki(zn(_h,"appInitialization.notifyExpectedFailure"),e)}const $h=jn("thirdPartyCloudStorage"),qh="v2";class Gh{constructor(e,t){this.fileType=e,this.assembleAttachment=t}}let Jh=[],Kh=null,Qh=!0,Zh=null;function Xh(e,t){if(!t)throw new Error("[getDragAndDropFiles] Callback cannot be null");if(e&&""!==e){if(Ir(Xn,rn.content,rn.task),!ev())throw ln;if(Zh)throw Zh=null,new Error("getDragAndDropFiles cannot be called twice");Zh=t,Qh=!0,Qs(zn(qh,"thirdPartyCloudStorage.getDragAndDropFiles"),"thirdPartyCloudStorage.getDragAndDropFiles",[e],Yh)}else{t([],{errorCode:Re.INVALID_ARGUMENTS})}}function Yh(e){if(Zh)if(e&&e.error)Zh([],e.error),Zh=null;else if(e&&e.fileChunk)try{Qh||0!==e.fileChunk.chunkSequence||($h("Last chunk is not received or 'endOfFile' value for previous chunk was not set to true"),Qh=!0,Zh([],{errorCode:Re.INTERNAL_ERROR,message:"error occurred while receiving data"}),Jh=[],Zh=null);const t=kp(e.fileChunk,e.fileType);if(t?(Kh||(Kh=new Gh(e.fileType,[])),Kh.assembleAttachment.push(t)):($h(`Received a null assemble attachment for when decoding chunk sequence ${e.fileChunk.chunkSequence}; not including the chunk in the assembled file.`),Zh?Zh([],{errorCode:Re.INTERNAL_ERROR,message:"error occurred while receiving data"}):Zh=null,Jh=[],Zh=null,Qh=!0),Qh=e.fileChunk.endOfFile,e.fileChunk.endOfFile&&Kh){const t=Fp(Kh.assembleAttachment,Kh.fileType);if(t){const n=new File([t],e.fileName,{type:t.type});Jh.push(n)}e.isLastFile&&Zh&&(Zh(Jh,e.error),Jh=[],Zh=null,Qh=!0),Kh=null}}catch(e){Zh&&(Zh([],{errorCode:Re.INTERNAL_ERROR,message:e}),Jh=[],Zh=null,Qh=!0)}else Zh([],{errorCode:Re.INTERNAL_ERROR,message:"data received is null"}),Jh=[],Zh=null,Qh=!0}function ev(){return!(!Ir(Xn)||!Xn.supports.thirdPartyCloudStorage)}const tv="v1";function nv(e,t){Ri(zn(tv,"initialize"),t).then((()=>{e&&e()}))}function rv(){Am()}function ov(){Im()}function iv(e){Ar(),Qs(zn(tv,"getContext"),"getContext",(t=>{t.frameContext||(t.frameContext=it.frameContext),e(t)}))}function av(e){Hi(zn(tv,"registerOnThemeChangeHandlerHelper"),e)}function sv(e){ts(zn(tv,"registerFullScreenHandler"),"fullScreenChange",e,[])}function cv(e){ts(zn(tv,"registerAppButtonClickHandler"),"appButtonClick",e,[rn.content])}function lv(e){ts(zn(tv,"registerAppButtonHoverEnterHandler"),"appButtonHoverEnter",e,[rn.content])}function uv(e){ts(zn(tv,"registerAppButtonHoverLeaveHandler"),"appButtonHoverLeave",e,[rn.content])}function dv(e){na(zn(tv,"registerBackButtonHandler"),e)}function fv(e){Pm(zn(tv,"registerOnLoadHandler"),e)}function pv(e){Rm(zn(tv,"registerBeforeUnloadHandler"),e)}function gv(e){ts(zn(tv,"registerFocusEnterHandler"),"focusEnter",e,[])}function mv(e){ts(zn(tv,"registerChangeSettingsHandler"),"changeSettings",e,[rn.content])}function hv(e,t){Ir(Xn),ka(zn(tv,"getTabInstances"),t).then((t=>{e(t)}))}function vv(e,t){Ir(Xn),Ma(zn(tv,"getMruTabInstances"),t).then((t=>{e(t)}))}function wv(e){Na(zn(tv,"shareDeepLink"),{subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function Cv(e,t){Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.task,rn.stage,rn.meetingStage);const n=null!=t?t:gn();Vi(zn(tv,"executeDeepLink"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function yv(e){xa(zn(tv,"setFrameContext"),e)}function bv(e,t,n){Ri(zn(tv,"initializeWithFrameContext"),n).then((()=>t&&t())),xa(zn(tv,"setFrameContext"),e)}const Sv="v1";function Ev(e){Fa(zn(Sv,"navigation.returnFocus"),e)}function Av(e,t){Ir(Xn);const n=null!=t?t:gn();Ra(zn(Sv,"navigation.navigateToTab"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function Iv(e,t){Ir(Xn,rn.content,rn.sidePanel,rn.settings,rn.remove,rn.task,rn.stage,rn.meetingStage);const n=null!=t?t:gn();Pa(zn(Sv,"navigation.navigateCrossDomain"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function Tv(e){Ir(Xn);const t=null!=e?e:gn();Oa(zn(Sv,"navigation.navigateBack")).then((()=>{t(!0)})).catch((e=>{t(!1,e.message)}))}const Pv="v1";function Ov(e){La(zn(Pv,"settings.setValidityState"),e)}function Rv(e){Ir(Xn,rn.content,rn.settings,rn.remove,rn.sidePanel),Ua(zn(Pv,"settings.getSettings")).then((t=>{e(t)}))}function Fv(e,t){Ir(Xn,rn.content,rn.settings,rn.sidePanel);const n=null!=t?t:gn();Da(zn(Pv,"settings.setSettings"),e).then((()=>{n(!0)})).catch((e=>{n(!1,e.message)}))}function kv(e){mi(zn(Pv,"settings.registerOnSaveHandler"),e)}function Mv(e){vi(zn(Pv,"settings.registerOnRemoveHandler"),e)}var Nv=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};const xv="v1";function Lv(e,t){const n=zn(xv,"tasks.startTask"),r=t?e=>{var n,r;return t(null!==(n=e.err)&&void 0!==n?n:"",null!==(r=e.result)&&void 0!==r?r:"")}:void 0;return void 0===e.card&&void 0===e.url||e.card?(Ir(Xn,rn.content,rn.sidePanel,rn.meetingStage),Qs(n,"tasks.startTask",[e],t)):void 0!==e.completionBotId?Uo(n,Vv(e),r):Lo(n,Hv(e),r),new vg}function Uv(e){e=_v(e);const{width:t,height:n}=e,r=Nv(e,["width","height"]);if(Object.keys(r).length)throw new Error("resize requires a TaskInfo argument containing only width and height");xo(zn(xv,"tasks.updateTask"),e)}function Dv(e,t){Do(zn(xv,"tasks.submitTask"),e,t)}function Hv(e){if(void 0===e.url)throw new Error("url property of taskInfo object can't be undefined");return{url:e.url,size:{height:e.height?e.height:sn.Small,width:e.width?e.width:sn.Small},title:e.title,fallbackUrl:e.fallbackUrl}}function Vv(e){if(void 0===e.url||void 0===e.completionBotId)throw new Error(`Both url ${e.url} and completionBotId ${e.completionBotId} are required for bot url dialog. At least one is undefined.`);return{url:e.url,size:{height:e.height?e.height:sn.Small,width:e.width?e.width:sn.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}function _v(e){return e.height=e.height?e.height:sn.Small,e.width=e.width?e.width:sn.Small,e}const Bv="v2";var Wv,jv;function zv(){return!(!Ir(Xn,rn.meetingStage,rn.sidePanel,rn.content)||!Xn.supports.interactive)}!function(e){e.guest="Guest",e.attendee="Attendee",e.presenter="Presenter",e.organizer="Organizer"}(Wv||(Wv={})),function(e){e.added="Added",e.alreadyExists="AlreadyExists",e.conflict="Conflict",e.notFound="NotFound"}(jv||(jv={}));class $v{getFluidTenantInfo(){return qv(),new Promise((e=>{e(Ws(zn(Bv,"interactive.getFluidTenantInfo"),"interactive.getFluidTenantInfo"))}))}getFluidToken(e){return qv(),new Promise((t=>{t(Ws(zn(Bv,"interactive.getFluidToken"),"interactive.getFluidToken",e))}))}getFluidContainerId(){return qv(),new Promise((e=>{e(Ws(zn(Bv,"interactive.getFluidContainerId"),"interactive.getFluidContainerId"))}))}setFluidContainerId(e){return qv(),new Promise((t=>{t(Ws(zn(Bv,"interactive.setFluidContainerId"),"interactive.setFluidContainerId",e))}))}getNtpTime(){return qv(),new Promise((e=>{e(Ws(zn(Bv,"interactive.getNtpTime"),"interactive.getNtpTime"))}))}registerClientId(e){return qv(),new Promise((t=>{t(Ws(zn(Bv,"interactive.registerClientId"),"interactive.registerClientId",e))}))}getClientRoles(e){return qv(),new Promise((t=>{t(Ws(zn(Bv,"interactive.getClientRoles"),"interactive.getClientRoles",e))}))}getClientInfo(e){return qv(),new Promise((t=>{t(Ws(zn(Bv,"interactive.getClientInfo"),"interactive.getClientInfo",e))}))}static create(){return qv(),new $v}}function qv(){if(!zv())throw new Error("LiveShareHost Not supported")}var Gv=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function Jv(e){try{return e.cartItems=Kv(e.cartItems),e}catch(e){throw new Error("Error deserializing cart")}}function Kv(e){return e.map((e=>{if(e.imageURL){const t=new URL(e.imageURL);e.imageURL=t}return e.accessories&&(e.accessories=Kv(e.accessories)),e}))}const Qv=e=>{try{return e.map((e=>{const{imageURL:t,accessories:n}=e,r=Gv(e,["imageURL","accessories"]),o=Object.assign({},r);return t&&(o.imageURL=t.href),n&&(o.accessories=Qv(n)),o}))}catch(e){throw new Error("Error serializing cart items")}};function Zv(e){if(!Array.isArray(e)||0===e.length)throw new Error("cartItems must be a non-empty array");for(const t of e)Yv(t),Xv(t.accessories)}function Xv(e){if(null!=e){if(!Array.isArray(e)||0===e.length)throw new Error("CartItem.accessories must be a non-empty array");for(const t of e){if(t.accessories)throw new Error("Item in CartItem.accessories cannot have accessories");Yv(t)}}}function Yv(e){if(!e.id)throw new Error("cartItem.id must not be empty");if(!e.name)throw new Error("cartItem.name must not be empty");tw(e.price),nw(e.quantity)}function ew(e){if(null!=e){if(!e)throw new Error("id must not be empty");if(!1===en(e))throw new Error("id must be a valid UUID")}}function tw(e){if("number"!=typeof e||e<0)throw new Error(`price ${e} must be a number not less than 0`);if(parseFloat(e.toFixed(3))!==e)throw new Error(`price ${e} must have at most 3 decimal places`)}function nw(e){if("number"!=typeof e||e<=0||parseInt(e.toString())!==e)throw new Error(`quantity ${e} must be an integer greater than 0`)}function rw(e){if(!Object.values(sw).includes(e))throw new Error(`cartStatus ${e} is not valid`)}const ow="v2",iw={majorVersion:1,minorVersion:1};var aw,sw;function cw(){if(Ir(Xn,rn.content,rn.task),!fw())throw ln;return Ws(zn(ow,"marketplace.getCart"),"marketplace.getCart",iw).then(Jv)}function lw(e){if(Ir(Xn,rn.content,rn.task),!fw())throw ln;if(!e)throw new Error("addOrUpdateCartItemsParams must be provided");return ew(null==e?void 0:e.cartId),Zv(null==e?void 0:e.cartItems),Ws(zn(ow,"marketplace.addOrUpdateCartItems"),"marketplace.addOrUpdateCartItems",Object.assign(Object.assign({},e),{cartItems:Qv(e.cartItems),cartVersion:iw})).then(Jv)}function uw(e){if(Ir(Xn,rn.content,rn.task),!fw())throw ln;if(!e)throw new Error("removeCartItemsParams must be provided");if(ew(null==e?void 0:e.cartId),!Array.isArray(null==e?void 0:e.cartItemIds)||0===(null==e?void 0:e.cartItemIds.length))throw new Error("cartItemIds must be a non-empty array");return Ws(zn(ow,"marketplace.removeCartItems"),"marketplace.removeCartItems",Object.assign(Object.assign({},e),{cartVersion:iw})).then(Jv)}function dw(e){if(Ir(Xn,rn.content,rn.task),!fw())throw ln;if(!e)throw new Error("updateCartStatusParams must be provided");return ew(null==e?void 0:e.cartId),rw(null==e?void 0:e.cartStatus),Ws(zn(ow,"marketplace.updateCartStatus"),"marketplace.updateCartStatus",Object.assign(Object.assign({},e),{cartVersion:iw})).then(Jv)}function fw(){return!(!Ir(Xn)||!Xn.supports.marketplace)}!function(e){e.TACAdminUser="TACAdminUser",e.TeamsAdminUser="TeamsAdminUser",e.TeamsEndUser="TeamsEndUser"}(aw||(aw={})),function(e){e.Open="Open",e.Processing="Processing",e.Processed="Processed",e.Closed="Closed",e.Error="Error"}(sw||(sw={}))})(),r})()));
//# sourceMappingURL=MicrosoftTeams.min.js.map